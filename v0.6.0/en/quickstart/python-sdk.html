<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python SDK Quickstart &mdash; Furiosa SDK Documentation furiosa-docs documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Command Line Tools Quickstart" href="cli.html" />
    <link rel="prev" title="API Key Settings" href="../installation/apikey.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Furiosa SDK Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">SDK installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/prerequisites.html">FuriosaAI SDK Installation + Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/driver.html">NPU Kernel Driver and Firmware Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/runtime.html">NPU Runtime Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/python-sdk.html">FuriosaAI Python SDK Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/apikey.html">API Key Settings</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quickstart</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python SDK Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#running-basic-python-code">Running Basic Python Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Tools Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced/quantization.html">Model Quantization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/supported_operators.html">List of NPU Acceleration Operators</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Furiosa SDK Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Python SDK Quickstart</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/quickstart/python-sdk.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-sdk-quickstart">
<h1>Python SDK Quickstart<a class="headerlink" href="#python-sdk-quickstart" title="Permalink to this headline"></a></h1>
<p>Using the FuriosaAI NPU Python SDK library, you can easily write Python programs that leverage the NPU.</p>
<p><strong>Minimum Requirements</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="../installation/driver.html"><span class="doc">NPU Kernel Driver and Firmware Installation</span></a></p></li>
<li><p><a class="reference internal" href="../installation/runtime.html"><span class="doc">NPU Runtime Installation</span></a></p></li>
<li><p>Python 3.7 or later (refer to <a class="reference internal" href="../installation/prerequisites.html#setuppython"><span class="std std-ref">Configuring the Python SDK Runtime Environment</span></a> if necessary)</p></li>
</ul>
<p>If the above requirements have been fulfilled, you can install the FuriosaAI NPU Python SDK library through PyPi.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pip install --upgrade <span class="s1">&#39;furiosa-sdk[runtime]~=0.1.0&#39;</span>
</pre></div>
</div>
<section id="running-basic-python-code">
<h2>Running Basic Python Code<a class="headerlink" href="#running-basic-python-code" title="Permalink to this headline"></a></h2>
<p>After the installation is complete, you can check whether the package is installed correctly by running the Python code as follows
and outputting the version information.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span> <span class="kn">from</span> <span class="nn">furiosa</span> <span class="kn">import</span> <span class="n">runtime</span>
<span class="n">INFO</span><span class="p">:</span><span class="n">furiosa</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">v1</span><span class="p">:</span><span class="n">successfully</span> <span class="n">loaded</span> <span class="n">dynamic</span> <span class="n">library</span> <span class="n">libnux</span><span class="o">.</span><span class="n">so</span><span class="mf">.1.0.0</span>

<span class="o">&gt;&gt;</span> <span class="n">runtime</span><span class="o">.</span><span class="n">__full_version__</span>
<span class="s1">&#39;Furiosa SDK Runtime .release:0.1.1+907338a44e91f176495b3c24fce3d9b1e626a662 (libnux 0.3.0-dev 9418048e4 2021-03-29 02:59:26)&#39;</span>
</pre></div>
</div>
<p>Inference can be executed by loading the model and creating a <code class="docutils literal notranslate"><span class="pre">session</span></code> object.
When first loading the model, the process of compiling and optimizing the model is performed internally.
This process is performed only when the model is initially loaded and may take from several seconds to
tens of seconds depending on the model. (Very awk, no set time frame?*)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sess</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s1">&#39;./MNISTnet_uint8_quant_without_softmax.tflite&#39;</span><span class="p">)</span>
<span class="go">num_slices: 16</span>
<span class="go">num_slices: 16</span>
<span class="go">[1/6] 🔍   Compiling from tflite to dfg</span>
<span class="go">Done in 0.001876285s</span>
<span class="go">[2/6] 🔍   Compiling from dfg to ldfg</span>
<span class="go">▪▪▪▪▪ [1/3] Splitting graph...Done in 1.2222888s</span>
<span class="go">▪▪▪▪▪ [2/3] Lowering...Done in 0.24661668s</span>
<span class="go">▪▪▪▪▪ [3/3] Precalculating operators...Done in 0.007146129s</span>
<span class="go">Done in 1.4769053s</span>
<span class="go">[3/6] 🔍   Compiling from ldfg to cdfg</span>
<span class="go">Done in 0.000111313s</span>
<span class="go">[4/6] 🔍   Compiling from cdfg to gir</span>
<span class="go">Done in 0.004966648s</span>
<span class="go">[5/6] 🔍   Compiling from gir to lir</span>
<span class="go">Done in 0.000273256s</span>
<span class="go">[6/6] 🔍   Compiling from lir to enf</span>
<span class="go">Done in 0.003491739s</span>
<span class="go">✨  Finished in 1.4908016s</span>
</pre></div>
</div>
<p>After loading a model, you can print its information and see a list of input/output tensors and general information about each tensor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sess</span><span class="o">.</span><span class="n">print_summary</span><span class="p">()</span>
<span class="go">Inputs:</span>
<span class="go">{0: TensorDesc: shape=(1, 28, 28, 1), dtype=uint8, format=NHWC, size=784, len=784}</span>
<span class="go">Outputs:</span>
<span class="go">{0: TensorDesc: shape=(1, 1, 1, 10), dtype=uint8, format=NHWC, size=10, len=10}</span>
</pre></div>
</div>
<p>You can run the inference by calling <code class="docutils literal notranslate"><span class="pre">session.run()</span></code>. <code class="docutils literal notranslate"><span class="pre">run()</span></code>
can take a list of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html">numpy.ndarray</a>
or <cite>numpy.ndarray</cite> as arguments.</p>
<p>For simple execution, let’s use <code class="docutils literal notranslate"><span class="pre">numpy</span></code> to create a random tensor according to the input tensor
and call <code class="docutils literal notranslate"><span class="pre">run</span></code> as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_meta</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">inputs</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_meta</span>
<span class="go">TensorDesc: shape=(1, 28, 28, 1), dtype=uint8, format=NHWC, size=784, len=784</span>

<span class="go">&gt;&gt; input = np.random.randint(-128, 127, input_meta.shape(), dtype=np.int8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span>
<span class="go">{0: &lt;Tensor: shape=(1, 1, 1, 10), dtype=DataType.UINT8, numpy=[[[[255   0 239   0 183   0 209   0 255 255]]]]&gt;}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">session.run(input)</span></code> call uses the NPU to run the inference and returns a list of tensors.
Since the returned result is a list, execute the following to get the <cite>numpy.ndarray</cite> of the first tensor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
<p>An example of the full code can be found at
<a class="reference external" href="https://github.com/furiosa-ai/furiosa-sdk/blob/main/examples/furiosa-sdk-runtime/quickstart_example.py">furiosa-sdk-runtime/quickstart_example.py</a>.</p>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://furiosa-ai.github.io/renegade-manual/references/python/">Python SDK Reference</a></p></li>
<li><p><a class="reference external" href="https://github.com/furiosa-ai/furiosa-sdk/tree/main/examples/furiosa-sdk-runtime">Python SDK Runtime examples</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../installation/apikey.html" class="btn btn-neutral float-left" title="API Key Settings" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cli.html" class="btn btn-neutral float-right" title="Command Line Tools Quickstart" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, FuriosaAI Inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>