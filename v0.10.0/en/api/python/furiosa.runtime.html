<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>furiosa.runtime package &mdash; Furiosa SDK Documentation 0.10.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="furiosa.optimizer package" href="furiosa.optimizer.html" />
    <link rel="prev" title="furiosa.common.transport package" href="furiosa.common.transport.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Furiosa SDK Documentation
          </a>
              <div class="version">
                0.10.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">FuriosaAI NPU</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../npu/warboy.html">FuriosaAI Warboy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FuriosaAI Software</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../software/intro.html">FuriosaAI SW Stack Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/installation.html">Driver, Firmware, and Runtime Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/python-sdk.html">Python SDK installation and user guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/c-sdk.html">C SDK installation and user guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/cli.html">Command Line Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/compiler.html">Compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/quantization.html">Model Quantization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/performance.html">Performance Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/profiler.html">Performance Profiling</a></li>
<li class="toctree-l1"><a class="reference external" href="https://furiosa-ai.github.io/furiosa-models/latest/">FuriosaAI Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/serving.html">Model Server (Serving Framework)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/kubernetes_support.html">Kubernetes Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/vm_support.html">Configuring Warboy Pass-through for Virtual Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/tutorials.html">Tutorial and Code Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../software/references.html">References</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="modules.html">Python SDK Reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="furiosa.common.html">furiosa.common package</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">furiosa.runtime package</a></li>
<li class="toctree-l3"><a class="reference internal" href="furiosa.optimizer.html">furiosa.optimizer package</a></li>
<li class="toctree-l3"><a class="reference internal" href="furiosa.quantizer.html">furiosa.quantizer package</a></li>
<li class="toctree-l3"><a class="reference internal" href="furiosa.server.html">furiosa.server package</a></li>
<li class="toctree-l3"><a class="reference internal" href="furiosa.serving.html">furiosa.serving package</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Release Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../releases/0.10.0.html">Release Notes - 0.10.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/0.9.0.html">Release Notes - 0.9.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/0.8.0.html">Release Notes - 0.8.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/0.7.0.html">Release Notes - 0.7.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/0.6.0.html">Release Notes - 0.6.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/0.5.0.html">Release Notes - 0.5.0</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Customer Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://furiosa-ai.atlassian.net/servicedesk/customer/portals/">FuriosaAI Customer Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../customer-support/bugs.html">Bug Report</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Previous Documents</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://furiosa-ai.github.io/docs/v0.9.0/en/">v0.9.0</a></li>
<li class="toctree-l1"><a class="reference external" href="https://furiosa-ai.github.io/docs/v0.8.0/en/">v0.8.0</a></li>
<li class="toctree-l1"><a class="reference external" href="https://furiosa-ai.github.io/docs/v0.6.0/en/">v0.6.0</a></li>
<li class="toctree-l1"><a class="reference external" href="https://furiosa-ai.github.io/docs/v0.5.0/en/">v0.5.0</a></li>
<li class="toctree-l1"><a class="reference external" href="https://furiosa-ai.github.io/docs/v0.2.0/en/">v0.2.0</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Furiosa SDK Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../software/references.html">References</a></li>
          <li class="breadcrumb-item"><a href="modules.html">Furiosa SDK 0.10.1 API Documentation</a></li>
      <li class="breadcrumb-item active">furiosa.runtime package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/api/python/furiosa.runtime.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-furiosa.runtime">
<span id="furiosa-runtime-package"></span><h1>furiosa.runtime package<a class="headerlink" href="#module-furiosa.runtime" title="Permalink to this heading"></a></h1>
<p>This package provides high-level Python APIs for Furiosa AI NPUs.</p>
<section id="runtime-variants">
<span id="id1"></span><h2>Runtime Variants<a class="headerlink" href="#runtime-variants" title="Permalink to this heading"></a></h2>
<p>The package is divided into three main modules:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Module</p></th>
<th class="head"><p>Methods</p></th>
<th class="head"><p>Generation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#module-furiosa.runtime" title="furiosa.runtime"><code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime</span></code></a></p></td>
<td><p>Async</p></td>
<td><p>Current</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.sync</span></code></p></td>
<td><p>Sync</p></td>
<td><p>Current</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-furiosa.runtime.session" title="furiosa.runtime.session"><code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.session</span></code></a></p></td>
<td><p>Sync</p></td>
<td><p><a class="reference internal" href="#use-of-legacy-modules"><span class="std std-ref">Legacy</span></a></p></td>
</tr>
</tbody>
</table>
<p>The current generation API was first introduced in FuriosaRT 0.10.0.
The legacy generation API (<a class="reference internal" href="#module-furiosa.runtime.session" title="furiosa.runtime.session"><code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.session</span></code></a>) is still supported for the backward compatibility
but slated for removal in the future release.
See <a class="reference internal" href="#use-of-legacy-modules"><span class="std std-ref">Use of legacy modules</span></a> for the more information.</p>
<p>Each module further contains two different sets of interfaces:</p>
<dl class="glossary">
<dt id="term-Runners">Runners<a class="headerlink" href="#term-Runners" title="Permalink to this term"></a></dt><dd><p>Runners provide a single class with <code class="docutils literal notranslate"><span class="pre">run</span></code> method.</p>
<p>Multiple <code class="docutils literal notranslate"><span class="pre">run</span></code> calls can be active at any time,
which is either possible by multiple tasks (for async modules) or threads (for sync modules).</p>
</dd>
<dt id="term-Queues">Queues<a class="headerlink" href="#term-Queues" title="Permalink to this term"></a></dt><dd><p>Queues provide two separate classes with <code class="docutils literal notranslate"><span class="pre">send</span></code> and <code class="docutils literal notranslate"><span class="pre">recv</span></code> methods respectively.
Each <code class="docutils literal notranslate"><span class="pre">send</span></code> should be paired with a context value to distinguish different <code class="docutils literal notranslate"><span class="pre">recv</span></code> outputs.</p>
<p>While multiple inputs can be sent at any time,
only a single task or thread should call <code class="docutils literal notranslate"><span class="pre">recv</span></code>.</p>
</dd>
</dl>
<section id="use-of-legacy-modules">
<span id="id2"></span><h3>Use of legacy modules<a class="headerlink" href="#use-of-legacy-modules" title="Permalink to this heading"></a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.10.0: </span>Any new use is strongly discouraged.</p>
</div>
<p>The package contains many historical modules,
including <a class="reference internal" href="#module-furiosa.runtime.session" title="furiosa.runtime.session"><code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.session</span></code></a> and <a class="reference internal" href="#module-furiosa.runtime.errors" title="furiosa.runtime.errors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.errors</span></code></a>
(see <a class="reference internal" href="#legacy-supports"><span class="std std-ref">Legacy Supports</span></a> for the full list).
As of 0.10.0 they are deprecated and will report deprecation warnings.</p>
<p>Legacy modules are largely wrappers around current APIs by default,
as such there exist some slight incompatibilities,
most notably the lack of <a class="reference internal" href="#module-furiosa-runtime-errors"><span class="std std-ref">error subclasses</span></a>.
Those intercompatibilities are marked as <strong>legacy only</strong> or <strong>current only</strong>.</p>
<p>If this is not desirable you may enable the <code class="docutils literal notranslate"><span class="pre">[legacy]</span></code> extra on install
to force the old implementation and disable compatibility warnings.
Please note that you <em>cannot</em> use current-only APIs when the extra is enabled.
For example:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Availability</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>With <code class="docutils literal notranslate"><span class="pre">[legacy]</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Current only</p></td>
<td><p><a class="reference internal" href="#furiosa.runtime.Runtime" title="furiosa.runtime.Runtime"><code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.Runtime</span></code></a></p></td>
<td><p><span style="color:green" title="Available">✔</span></p></td>
<td><p><span style="color:red" title="Not available">✘</span></p></td>
</tr>
<tr class="row-odd"><td><p>Current &amp; Legacy</p></td>
<td><p><a class="reference internal" href="#furiosa.runtime.full_version" title="furiosa.runtime.full_version"><code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.full_version</span></code></a></p></td>
<td><p><span style="color:green" title="Available">✔</span></p></td>
<td><p><span style="color:green" title="Available">✔</span></p></td>
</tr>
<tr class="row-even"><td><p>Legacy</p></td>
<td><p><a class="reference internal" href="#furiosa.runtime.session.Session" title="furiosa.runtime.session.Session"><code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.session.Session</span></code></a></p></td>
<td><p><span style="color:yellow" title="Available but warns">⚠️</span></p></td>
<td><p><span style="color:green" title="Available">✔</span></p></td>
</tr>
<tr class="row-odd"><td><p>Legacy only</p></td>
<td><p><a class="reference internal" href="#module-furiosa.runtime.errors" title="furiosa.runtime.errors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.errors.NativeError</span></code></a></p></td>
<td><p><span style="color:red" title="Not available">✘</span></p></td>
<td><p><span style="color:green" title="Available">✔</span></p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="model-inputs">
<span id="id3"></span><h2>Model Inputs<a class="headerlink" href="#model-inputs" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.ModelSource">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">ModelSource</span></span><a class="headerlink" href="#furiosa.runtime.ModelSource" title="Permalink to this definition"></a></dt>
<dd><p>Represents a value that specifies how to load the model.
This is <em>not</em> a real class, but a type alias for either:</p>
<ol class="arabic simple">
<li><p>Any <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Path</span></code></a>-like type or a string, representing a path to the model file.</p></li>
<li><p>Bytes, byte array or any class with <code class="docutils literal notranslate"><span class="pre">__bytes__</span></code> method, representing a raw model data.</p></li>
</ol>
<p>Future versions may allow additional types.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.</span></p>
</div>
</dd></dl>

<p>See <a class="reference internal" href="../../software/compiler.html#compiler"><span class="std std-ref">Compiler</span></a> for supported model formats and restrictions.</p>
</section>
<section id="tensor-inputs-and-outputs">
<span id="id4"></span><h2>Tensor Inputs and Outputs<a class="headerlink" href="#tensor-inputs-and-outputs" title="Permalink to this heading"></a></h2>
<p>Tensors use a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> type from <a class="reference external" href="https://numpy.org/">Numpy</a> as a primary representation,
but the following type aliases exist for documentation and typing purposes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.TensorArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">TensorArray</span></span><a class="headerlink" href="#furiosa.runtime.TensorArray" title="Permalink to this definition"></a></dt>
<dd><p>A type alias for a list of input tensors.
This is <em>not</em> a real class, but can be either:</p>
<ul class="simple">
<li><p>Any iterable of <a class="reference internal" href="#furiosa.runtime.Tensor" title="furiosa.runtime.Tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Tensor</span></code></a>s (but the iterable itself shouldn’t be an <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a>)</p></li>
<li><p>A single <a class="reference internal" href="#furiosa.runtime.Tensor" title="furiosa.runtime.Tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Tensor</span></code></a>, if only one tensor is required</p></li>
</ul>
<p>The corresponding output type is always a list of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a>s.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.</span></p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.Tensor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">Tensor</span></span><a class="headerlink" href="#furiosa.runtime.Tensor" title="Permalink to this definition"></a></dt>
<dd><p>A type alias for a single input tensor.
This is <em>not</em> a real class, but can be either:</p>
<ul class="simple">
<li><p>A single <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p></li>
<li><p>A single scalar value or <a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.generic" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.generic</span></code></a>, if the tensor was zero-dimensional</p></li>
<li><p>Any other value that implements the NumPy <a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.interface.html">array interface</a></p></li>
</ul>
<p>The corresponding output type is always a single <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.</span></p>
</div>
</dd></dl>

<section id="legacy-interface">
<span id="legacy-tensor-inputs-and-outputs"></span><h3>Legacy Interface<a class="headerlink" href="#legacy-interface" title="Permalink to this heading"></a></h3>
<p>Legacy interfaces support the same input and output types,
but due to the technical reasons, following concrete types are used for tensor outputs.</p>
<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.tensor.TensorArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.tensor.</span></span><span class="sig-name descname"><span class="pre">TensorArray</span></span><a class="headerlink" href="#furiosa.runtime.tensor.TensorArray" title="Permalink to this definition"></a></dt>
<dd><p>A subclass of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a>, so that all items should be <a class="reference internal" href="#furiosa.runtime.tensor.Tensor" title="furiosa.runtime.tensor.Tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Tensor</span></code></a> and additional methods are provided.</p>
<p><a class="reference internal" href="#use-of-legacy-modules"><span class="std std-ref">Legacy only</span></a>:
This class used to be not subclassed from <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> and
supported only <code class="docutils literal notranslate"><span class="pre">len(array)</span></code>, <code class="docutils literal notranslate"><span class="pre">array[i]</span></code> and <code class="docutils literal notranslate"><span class="pre">array[i]</span> <span class="pre">=</span> <span class="pre">tensor</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.tensor.TensorArray.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.tensor.TensorArray.is_empty" title="Permalink to this definition"></a></dt>
<dd><p><code class="code docutils literal notranslate"><span class="pre">True</span></code> if the array is empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.tensor.TensorArray.view">
<span class="sig-name descname"><span class="pre">view</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.tensor.TensorArray.view" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a> views to all tensors, as in <a class="reference internal" href="#furiosa.runtime.tensor.Tensor.view" title="furiosa.runtime.tensor.Tensor.view"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Tensor.view</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)">numpy.ndarray</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.tensor.TensorArray.numpy">
<span class="sig-name descname"><span class="pre">numpy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.tensor.TensorArray.numpy" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of <em>copies</em> of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a> from all tensors, as in <a class="reference internal" href="#furiosa.runtime.tensor.Tensor.numpy" title="furiosa.runtime.tensor.Tensor.numpy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Tensor.numpy</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)">numpy.ndarray</a>]</p>
</dd>
</dl>
</dd></dl>

<aside class="topic" id="legacy-tensorarray-as-input">
<p class="topic-title">When used as an input type</p>
<p>This type can be also internally converted from other types:</p>
<ul class="simple">
<li><p>A list of <a class="reference internal" href="#legacy-tensor-as-input"><span class="std std-ref">any types</span></a> that can be converted to <a class="reference internal" href="#furiosa.runtime.tensor.Tensor" title="furiosa.runtime.tensor.Tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Tensor</span></code></a></p></li>
<li><p>A single type that can be converted to <a class="reference internal" href="#furiosa.runtime.tensor.Tensor" title="furiosa.runtime.tensor.Tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Tensor</span></code></a>, if only one tensor is required</p></li>
</ul>
</aside>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.tensor.Tensor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.tensor.</span></span><span class="sig-name descname"><span class="pre">Tensor</span></span><a class="headerlink" href="#furiosa.runtime.tensor.Tensor" title="Permalink to this definition"></a></dt>
<dd><p>A subclass of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> providing additional methods.</p>
<p><a class="reference internal" href="#use-of-legacy-modules"><span class="std std-ref">Legacy only</span></a>:
This class used to be not subclassed from <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> and
no methods were available except documented here.</p>
<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.tensor.Tensor.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#furiosa.runtime.tensor.Tensor.shape" title="Permalink to this definition"></a></dt>
<dd><p>Same as <code class="docutils literal notranslate"><span class="pre">tensor.view().shape</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.tensor.Tensor.numpy_dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">numpy_dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><span class="pre">type</span></a></em><a class="headerlink" href="#furiosa.runtime.tensor.Tensor.numpy_dtype" title="Permalink to this definition"></a></dt>
<dd><p>Same as <code class="docutils literal notranslate"><span class="pre">tensor.view().dtype.type</span></code>.
Returns a Numpy <em>type object</em> like <a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.int8" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.int8</span></code></a>.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.10: </span>Contrary to its name, it didn’t return <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.dtype</span></code></a> which was misleading and thus deprecated.
Use <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.dtype.html#numpy.ndarray.dtype" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tensor.view().dtype</span></code></a> instead.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.tensor.Tensor.copy_from">
<span class="sig-name descname"><span class="pre">copy_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.tensor.Tensor.copy_from" title="Permalink to this definition"></a></dt>
<dd><p>Replaces the entire tensor with given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><em>numpy.ndarray</em></a><em> or </em><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.generic" title="(in NumPy v1.26)"><em>numpy.generic</em></a>) – What to replace this tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.tensor.Tensor.view">
<span class="sig-name descname"><span class="pre">view</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.tensor.Tensor.view" title="Permalink to this definition"></a></dt>
<dd><p>Returns a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a> view to this tensor.
Multiple views to the same tensor refer to the same memory region.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.tensor.Tensor.numpy">
<span class="sig-name descname"><span class="pre">numpy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.tensor.Tensor.numpy" title="Permalink to this definition"></a></dt>
<dd><p>Returns a <em>copy</em> of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a> from this tensor.
Multiple copies to the same tensor are independent from each other and the original tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<aside class="topic" id="legacy-tensor-as-input">
<p class="topic-title">When used as an input type</p>
<p>This type can be also internally converted from other types:</p>
<ul class="simple">
<li><p>A single <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p></li>
<li><p>A single <a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.generic" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.generic</span></code></a>, if the tensor was zero-dimensional</p></li>
</ul>
</aside>
</dd></dl>

</section>
</section>
<section id="runtime-object">
<span id="id5"></span><h2>Runtime Object<a class="headerlink" href="#runtime-object" title="Permalink to this heading"></a></h2>
<p>Runtime objects are associated with a set of NPU devices and can be used to create inference sessions.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10: </span>Previously sessions could only be created directly via
<a class="reference internal" href="#furiosa.runtime.session.create" title="furiosa.runtime.session.create"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create</span></code></a> and <a class="reference internal" href="#furiosa.runtime.session.create_async" title="furiosa.runtime.session.create_async"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_async</span></code></a> functions.</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.Runtime">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">Runtime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Runtime" title="Permalink to this definition"></a></dt>
<dd><p>Asynchronous runtime object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><em>None</em>) – A textual <a class="reference internal" href="#device-specification">device specification</a>, see the section for defaults</p>
</dd>
</dl>
<p>This type is mainly used as a context manager:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">with</span> <span class="n">Runtime</span><span class="p">()</span> <span class="k">as</span> <span class="n">runtime</span><span class="p">:</span>
    <span class="k">async</span> <span class="k">with</span> <span class="n">runtime</span><span class="o">.</span><span class="n">create_runner</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">runner</span><span class="p">:</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</pre></div>
</div>
<p>The runtime acts as a scope for all subsequent inference sessions.
Its lifetime starts when the object is successfully created,
and ends when the <a class="reference internal" href="#furiosa.runtime.Runtime.close" title="furiosa.runtime.Runtime.close"><code class="xref py py-obj docutils literal notranslate"><span class="pre">close</span></code></a> method is called for the first time.
All other methods will fail when the runtime has been closed.</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Runtime.close">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Runtime.close" title="Permalink to this definition"></a></dt>
<dd><p>Tries to close the runtime if not yet closed.
Waits until the runtime is indeed closed,
or it takes too much time to close (in which case the runtime may still be open).</p>
<p>The context manager internally calls this method at the end,
and warns when the timeout has been reached.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="code docutils literal notranslate"><span class="pre">True</span></code> if the runtime has been closed in time.</p>
</dd>
</dl>
</dd></dl>

<p>Most other methods are documented in the <a class="reference internal" href="#runner-api"><span class="std std-ref">Runner API</span></a> and <a class="reference internal" href="#queue-api"><span class="std std-ref">Queue API</span></a> sections.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.sync.Runtime">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.sync.</span></span><span class="sig-name descname"><span class="pre">Runtime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.sync.Runtime" title="Permalink to this definition"></a></dt>
<dd><p>Same as <a class="reference internal" href="#furiosa.runtime.Runtime" title="furiosa.runtime.Runtime"><code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.Runtime</span></code></a>, but all <code class="docutils literal notranslate"><span class="pre">async</span></code> methods are made synchronous.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">Runtime</span><span class="p">()</span> <span class="k">as</span> <span class="n">runtime</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">runtime</span><span class="o">.</span><span class="n">create_runner</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">runner</span><span class="p">:</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<section id="device-specification">
<span id="id6"></span><h3>Device Specification<a class="headerlink" href="#device-specification" title="Permalink to this heading"></a></h3>
<p>Runtime identifies a set of NPU devices by a textual string.</p>
<dl>
<dt>Implicit, any available device</dt><dd><p><code class="docutils literal notranslate"><span class="pre">ARCH(X)*Y</span></code> denotes any set of available devices where:</p>
<ul class="simple">
<li><p><em>ARCH</em> is a target architecture and currently should be <code class="docutils literal notranslate"><span class="pre">warboy</span></code>.</p></li>
<li><p><em>X</em> is the number of PEs to be used per each device.</p></li>
<li><p><em>Y</em> is the number of devices to be used.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">(1)</span></code> can be omitted, so for example <code class="docutils literal notranslate"><span class="pre">warboy*1</span></code> is a valid specification.</p>
</dd>
<dt>Device and PE index pair</dt><dd><p><code class="docutils literal notranslate"><span class="pre">npu:X:Y</span></code> denotes a PE number <em>Y</em> in the device number <em>X</em>,
where <em>X</em> and <em>Y</em> are 0-based indices.</p>
<p><code class="docutils literal notranslate"><span class="pre">npu:X:Y-Z</span></code> denotes a fused PE made of two PEs <code class="docutils literal notranslate"><span class="pre">npu:X:Y</span></code> and <code class="docutils literal notranslate"><span class="pre">npu:X:Z</span></code>.
Intermediate tensors may occupy multiple PE worth of memory in this mode.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Device and PE indices are determined by the kernel driver,
and so should not be heavily relied upon especially when there are multiple devices.</p>
</div>
</dd>
<dt>Raw device name</dt><dd><p><code class="docutils literal notranslate"><span class="pre">npuXpeY</span></code> and <code class="docutils literal notranslate"><span class="pre">npuXpeY-Z</span></code> are same as <code class="docutils literal notranslate"><span class="pre">npu:X:Y</span></code> and <code class="docutils literal notranslate"><span class="pre">npu:X:Y-Z</span></code> respectively.</p>
<p>Those names are same as raw device file names in <code class="docutils literal notranslate"><span class="pre">/dev</span></code>.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.10.0.</span></p>
</div>
</dd>
<dt>Multiple devices</dt><dd><p>Aforementioned specifications can be connected with <code class="docutils literal notranslate"><span class="pre">,</span></code>.
For example <code class="docutils literal notranslate"><span class="pre">npu:1:0,npu:1:1</span></code> is a valid specification.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Implicit specifications will allocate devices in greedy manner,
so the runtime may fail to initialize even when there exist valid allocations.
Mixed specifications like <code class="docutils literal notranslate"><span class="pre">warboy*1,npu:1:0</span></code> is not recommended for this reason.</p>
</div>
</dd>
<dt>Environment variables</dt><dd><p>Following environment variables will be used for the default device specification
when no explicit device specification is given.</p>
<dl class="std envvar">
<dt class="sig sig-object std" id="envvar-FURIOSA_DEVICES">
<span class="sig-name descname"><span class="pre">FURIOSA_DEVICES</span></span><a class="headerlink" href="#envvar-FURIOSA_DEVICES" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.</span></p>
</div>
<p>Takes precedence over <span class="target" id="index-0"></span><a class="reference internal" href="#envvar-NPU_DEVNAME"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NPU_DEVNAME</span></code></a> if given.</p>
<p>This environment variable is <a class="reference internal" href="#use-of-legacy-modules"><span class="std std-ref">current only</span></a>.</p>
</dd></dl>

<dl class="std envvar">
<dt class="sig sig-object std" id="envvar-NPU_DEVNAME">
<span class="sig-name descname"><span class="pre">NPU_DEVNAME</span></span><a class="headerlink" href="#envvar-NPU_DEVNAME" title="Permalink to this definition"></a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.10: </span>Use <span class="target" id="index-1"></span><a class="reference internal" href="#envvar-FURIOSA_DEVICES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FURIOSA_DEVICES</span></code></a> instead.</p>
</div>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Environment variables can never override the explicit specification.</p>
</div>
</dd>
<dt>Default devices</dt><dd><p>If there were no device specification or relevant environment variables,
then it’s assumed that there is a single Warboy device with 2 fused PEs and
the default specification <code class="docutils literal notranslate"><span class="pre">warboy(2)*1</span></code> is used.</p>
</dd>
</dl>
</section>
</section>
<section id="model-metadata">
<span id="id7"></span><h2>Model Metadata<a class="headerlink" href="#model-metadata" title="Permalink to this heading"></a></h2>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.10: </span>Those types were provided by the <a class="reference internal" href="#module-furiosa.runtime.model" title="furiosa.runtime.model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.model</span></code></a> module.</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.Axis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">Axis</span></span><a class="headerlink" href="#furiosa.runtime.Axis" title="Permalink to this definition"></a></dt>
<dd><p>Represents an inferred axis of tensors.</p>
<p>This type is used only for compiler diagnostics and doesn’t affect the execution.</p>
<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.Axis.WIDTH">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">WIDTH</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.Axis" title="furiosa.runtime.Axis"><span class="pre">Axis</span></a></em><a class="headerlink" href="#furiosa.runtime.Axis.WIDTH" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.Axis.HEIGHT">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HEIGHT</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.Axis" title="furiosa.runtime.Axis"><span class="pre">Axis</span></a></em><a class="headerlink" href="#furiosa.runtime.Axis.HEIGHT" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.Axis.CHANNEL">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CHANNEL</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.Axis" title="furiosa.runtime.Axis"><span class="pre">Axis</span></a></em><a class="headerlink" href="#furiosa.runtime.Axis.CHANNEL" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.Axis.BATCH">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BATCH</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.Axis" title="furiosa.runtime.Axis"><span class="pre">Axis</span></a></em><a class="headerlink" href="#furiosa.runtime.Axis.BATCH" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.Axis.UNKNOWN">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">UNKNOWN</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.Axis" title="furiosa.runtime.Axis"><span class="pre">Axis</span></a></em><a class="headerlink" href="#furiosa.runtime.Axis.UNKNOWN" title="Permalink to this definition"></a></dt>
<dd><p>Constants for well-known axes:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Abbreviation</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#furiosa.runtime.Axis.WIDTH" title="furiosa.runtime.Axis.WIDTH"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WIDTH</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p>Width</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#furiosa.runtime.Axis.HEIGHT" title="furiosa.runtime.Axis.HEIGHT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HEIGHT</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">H</span></code></p></td>
<td><p>Height</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#furiosa.runtime.Axis.CHANNEL" title="furiosa.runtime.Axis.CHANNEL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CHANNEL</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td><p>Depth, or input channel for convolutions</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#furiosa.runtime.Axis.BATCH" title="furiosa.runtime.Axis.BATCH"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BATCH</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></td>
<td><p>Batch, or output channel for convolutions</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#furiosa.runtime.Axis.UNKNOWN" title="furiosa.runtime.Axis.UNKNOWN"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UNKNOWN</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">?</span></code></p></td>
<td><p>Other axes compiler has failed to infer</p></td>
</tr>
</tbody>
</table>
<p>This enumeration also contains some private axes internally used by the compiler.
Their names and meanings are not stable and can change at any time.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.DataType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">DataType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.DataType" title="Permalink to this definition"></a></dt>
<dd><p>Represents a data type for each item in the tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>v</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – A value to determine its data type</p>
</dd>
</dl>
<p>The constructor can be also used to determine an NPU-supported data type from other objects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">DataType</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>                       <span class="c1"># =&gt; DataType.FLOAT32</span>
<span class="n">DataType</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">))</span>   <span class="c1"># =&gt; DataType.INT8</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.DataType.FLOAT16">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FLOAT16</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.DataType" title="furiosa.runtime.DataType"><span class="pre">DataType</span></a></em><a class="headerlink" href="#furiosa.runtime.DataType.FLOAT16" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.DataType.FLOAT32">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FLOAT32</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.DataType" title="furiosa.runtime.DataType"><span class="pre">DataType</span></a></em><a class="headerlink" href="#furiosa.runtime.DataType.FLOAT32" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.DataType.BFLOAT16">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BFLOAT16</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.DataType" title="furiosa.runtime.DataType"><span class="pre">DataType</span></a></em><a class="headerlink" href="#furiosa.runtime.DataType.BFLOAT16" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.DataType.INT8">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">INT8</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.DataType" title="furiosa.runtime.DataType"><span class="pre">DataType</span></a></em><a class="headerlink" href="#furiosa.runtime.DataType.INT8" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.DataType.INT16">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">INT16</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.DataType" title="furiosa.runtime.DataType"><span class="pre">DataType</span></a></em><a class="headerlink" href="#furiosa.runtime.DataType.INT16" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.DataType.INT32">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">INT32</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.DataType" title="furiosa.runtime.DataType"><span class="pre">DataType</span></a></em><a class="headerlink" href="#furiosa.runtime.DataType.INT32" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.DataType.INT64">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">INT64</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.DataType" title="furiosa.runtime.DataType"><span class="pre">DataType</span></a></em><a class="headerlink" href="#furiosa.runtime.DataType.INT64" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.DataType.UINT8">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">UINT8</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.DataType" title="furiosa.runtime.DataType"><span class="pre">DataType</span></a></em><a class="headerlink" href="#furiosa.runtime.DataType.UINT8" title="Permalink to this definition"></a></dt>
<dd><p>Constants for supported types:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#furiosa.runtime.DataType.FLOAT16" title="furiosa.runtime.DataType.FLOAT16"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FLOAT16</span></code></a></p></td>
<td><p>IEEE 754 half-precision (<a class="reference external" href="https://en.wikipedia.org/wiki/Single-precision_floating-point_format">binary16</a>) floating point type</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#furiosa.runtime.DataType.FLOAT32" title="furiosa.runtime.DataType.FLOAT32"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FLOAT32</span></code></a></p></td>
<td><p>IEEE 754 single-precision (<a class="reference external" href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format">binary32</a>) floating point type</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#furiosa.runtime.DataType.BFLOAT16" title="furiosa.runtime.DataType.BFLOAT16"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BFLOAT16</span></code></a></p></td>
<td><p><a class="reference external" href="https://en.wikipedia.org/wiki/Bfloat16_floating-point_format">Bfloat16</a> floating point type</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#furiosa.runtime.DataType.INT8" title="furiosa.runtime.DataType.INT8"><code class="xref py py-obj docutils literal notranslate"><span class="pre">INT8</span></code></a></p></td>
<td><p>8-bit signed integer type</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#furiosa.runtime.DataType.INT16" title="furiosa.runtime.DataType.INT16"><code class="xref py py-obj docutils literal notranslate"><span class="pre">INT16</span></code></a></p></td>
<td><p>16-bit signed integer type</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#furiosa.runtime.DataType.INT32" title="furiosa.runtime.DataType.INT32"><code class="xref py py-obj docutils literal notranslate"><span class="pre">INT32</span></code></a></p></td>
<td><p>32-bit signed integer type</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#furiosa.runtime.DataType.INT64" title="furiosa.runtime.DataType.INT64"><code class="xref py py-obj docutils literal notranslate"><span class="pre">INT64</span></code></a></p></td>
<td><p>64-bit signed integer type</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#furiosa.runtime.DataType.UINT8" title="furiosa.runtime.DataType.UINT8"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UINT8</span></code></a></p></td>
<td><p>8-bit unsigned integer type</p></td>
</tr>
</tbody>
</table>
<p>This enumeration also contains some private types internally used by the compiler.
Their representations are not stable and can change at any time.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.DataType.numpy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">numpy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><span class="pre">numpy.dtype</span></a></em><a class="headerlink" href="#furiosa.runtime.DataType.numpy" title="Permalink to this definition"></a></dt>
<dd><p>Returns a corresponding Numpy data type object.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.12)"><strong>ValueError</strong></a> – if this type has no Numpy equivalent</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.DataType.numpy_dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">numpy_dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><span class="pre">type</span></a></em><a class="headerlink" href="#furiosa.runtime.DataType.numpy_dtype" title="Permalink to this definition"></a></dt>
<dd><p>Returns a Numpy <em>type object</em> corresponding to this data type, like <a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.int8" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.int8</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.12)"><strong>ValueError</strong></a> – if this type has no Numpy equivalent</p>
</dd>
</dl>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.10: </span>Contrary to its name, it didn’t return <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.dtype</span></code></a> which was misleading and thus deprecated.
Use the <a class="reference internal" href="#furiosa.runtime.DataType.numpy" title="furiosa.runtime.DataType.numpy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code></a> property instead.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.TensorDesc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">TensorDesc</span></span><a class="headerlink" href="#furiosa.runtime.TensorDesc" title="Permalink to this definition"></a></dt>
<dd><p>Describes a single tensor in the input or output.</p>
<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.TensorDesc.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span> <span class="pre">or</span> <span class="pre">None</span></em><a class="headerlink" href="#furiosa.runtime.TensorDesc.name" title="Permalink to this definition"></a></dt>
<dd><p>A tensor name if any. This is only available for some model formats.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.TensorDesc.ndim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ndim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#furiosa.runtime.TensorDesc.ndim" title="Permalink to this definition"></a></dt>
<dd><p>The number of dimensions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.TensorDesc.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.TensorDesc.dim" title="Permalink to this definition"></a></dt>
<dd><p>The size of <code class="xref py py-obj docutils literal notranslate"><span class="pre">idx</span></code>-th dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – 0-based dimension index</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.TensorDesc.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#furiosa.runtime.TensorDesc.shape" title="Permalink to this definition"></a></dt>
<dd><p>The shape of given tensor.</p>
<p><code class="code docutils literal notranslate"><span class="pre">desc.shape</span></code> is conceptually same as <code class="code docutils literal notranslate"><span class="pre">(desc.dim(0),</span> <span class="pre">...,</span> <span class="pre">desc.dim(desc.ndim</span> <span class="pre">-</span> <span class="pre">1))</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.TensorDesc.axis">
<span class="sig-name descname"><span class="pre">axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.TensorDesc.axis" title="Permalink to this definition"></a></dt>
<dd><p>The compiler-inferred axis for <code class="xref py py-obj docutils literal notranslate"><span class="pre">idx</span></code>-th dimension. Defaults to <a class="reference internal" href="#furiosa.runtime.Axis.UNKNOWN" title="furiosa.runtime.Axis.UNKNOWN"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Axis.UNKNOWN</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – 0-based dimension index</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#furiosa.runtime.Axis" title="furiosa.runtime.Axis">Axis</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.TensorDesc.size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#furiosa.runtime.TensorDesc.size" title="Permalink to this definition"></a></dt>
<dd><p>The byte size of given tensor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.TensorDesc.stride">
<span class="sig-name descname"><span class="pre">stride</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.TensorDesc.stride" title="Permalink to this definition"></a></dt>
<dd><p>The stride of <code class="xref py py-obj docutils literal notranslate"><span class="pre">idx</span></code>-th dimension in <strong>items</strong>.
It’s a distance between two adjacent elements in given dimension;
this convention notably differs from <code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray.strides</span></code> which is in bytes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – 0-based dimension index</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.TensorDesc.length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#furiosa.runtime.TensorDesc.length" title="Permalink to this definition"></a></dt>
<dd><p>The number of total elements in given tensor.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.TensorDesc.format">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">format</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#furiosa.runtime.TensorDesc.format" title="Permalink to this definition"></a></dt>
<dd><p>A concatenation of abbreviated axes in given tensor, e.g. <code class="docutils literal notranslate"><span class="pre">NCHW</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.TensorDesc.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.DataType" title="furiosa.runtime.DataType"><span class="pre">DataType</span></a></em><a class="headerlink" href="#furiosa.runtime.TensorDesc.dtype" title="Permalink to this definition"></a></dt>
<dd><p>A data type for each element.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.TensorDesc.numpy_dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">numpy_dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.26)"><span class="pre">numpy.dtype</span></a></em><a class="headerlink" href="#furiosa.runtime.TensorDesc.numpy_dtype" title="Permalink to this definition"></a></dt>
<dd><p>A <a class="reference external" href="https://numpy.org/">Numpy</a> data type for each element. Same as <code class="xref py py-obj docutils literal notranslate"><span class="pre">desc.dtype.numpy</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><a class="headerlink" href="#furiosa.runtime.Model" title="Permalink to this definition"></a></dt>
<dd><p>Describes a single model with possibly multiple input and output tensors.</p>
<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.Model.input_num">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_num</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#furiosa.runtime.Model.input_num" title="Permalink to this definition"></a></dt>
<dd><p>The number of input tensors.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.Model.output_num">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_num</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#furiosa.runtime.Model.output_num" title="Permalink to this definition"></a></dt>
<dd><p>The number of output tensors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Model.input">
<span class="sig-name descname"><span class="pre">input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Model.input" title="Permalink to this definition"></a></dt>
<dd><p>A description for <code class="xref py py-obj docutils literal notranslate"><span class="pre">idx</span></code>-th input tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – 0-based tensor index</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#furiosa.runtime.TensorDesc" title="furiosa.runtime.TensorDesc">TensorDesc</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Model.output">
<span class="sig-name descname"><span class="pre">output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Model.output" title="Permalink to this definition"></a></dt>
<dd><p>A description for <code class="xref py py-obj docutils literal notranslate"><span class="pre">idx</span></code>-th output tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – 0-based tensor index</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#furiosa.runtime.TensorDesc" title="furiosa.runtime.TensorDesc">TensorDesc</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Model.inputs">
<span class="sig-name descname"><span class="pre">inputs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Model.inputs" title="Permalink to this definition"></a></dt>
<dd><p>A list of descriptions for each input tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a>[<a class="reference internal" href="#furiosa.runtime.TensorDesc" title="furiosa.runtime.TensorDesc">TensorDesc</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Model.outputs">
<span class="sig-name descname"><span class="pre">outputs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Model.outputs" title="Permalink to this definition"></a></dt>
<dd><p>A list of descriptions for each output tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a>[<a class="reference internal" href="#furiosa.runtime.TensorDesc" title="furiosa.runtime.TensorDesc">TensorDesc</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Model.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Model.summary" title="Permalink to this definition"></a></dt>
<dd><p>A human-readable summary of given model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="go">Inputs:</span>
<span class="go">{0: TensorDesc(shape=(1, 1, 28, 28), dtype=FLOAT32, format=NCHW, size=3136, len=784)}</span>
<span class="go">Outputs:</span>
<span class="go">{0: TensorDesc(shape=(1, 10), dtype=FLOAT32, format=??, size=40, len=10)}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Model.print_summary">
<span class="sig-name descname"><span class="pre">print_summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Model.print_summary" title="Permalink to this definition"></a></dt>
<dd><p>Same as <code class="code docutils literal notranslate"><span class="pre">print(model.summary())</span></code>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="runner-api">
<span id="id8"></span><h2>Runner API<a class="headerlink" href="#runner-api" title="Permalink to this heading"></a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.</span></p>
</div>
<p>Runner APIs provide a simple functional interface via a single <a class="reference internal" href="#furiosa.runtime.Runner" title="furiosa.runtime.Runner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Runner</span></code></a> class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.furiosa.runtime.Runtime.create_runner">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.Runtime.</span></span><span class="sig-name descname"><span class="pre">create_runner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.furiosa.runtime.Runtime.create_runner" title="Permalink to this definition"></a></dt>
<dd><p>Creates a new inference session for given model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#furiosa.runtime.ModelSource" title="furiosa.runtime.ModelSource"><em>ModelSource</em></a>) – Model path or data</p></li>
<li><p><strong>worker_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><em>None</em>) – The number of worker threads</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><em>None</em>) – The number of batches per each run</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#furiosa.runtime.Runner" title="furiosa.runtime.Runner">Runner</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.create_runner">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">create_runner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.create_runner" title="Permalink to this definition"></a></dt>
<dd><p>Same as above, but the runtime is implicitly created and
will be closed when the session couldn’t be created or gets closed.</p>
<p>See <a class="reference internal" href="#furiosa.runtime.furiosa.runtime.Runtime.create_runner" title="furiosa.runtime.furiosa.runtime.Runtime.create_runner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_runner</span></code></a> and <a class="reference internal" href="#furiosa.runtime.Runtime" title="furiosa.runtime.Runtime"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Runtime</span></code></a> for arguments.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.Runner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">Runner</span></span><a class="headerlink" href="#furiosa.runtime.Runner" title="Permalink to this definition"></a></dt>
<dd><p>An inference session
returned by <a class="reference internal" href="#furiosa.runtime.furiosa.runtime.Runtime.create_runner" title="furiosa.runtime.furiosa.runtime.Runtime.create_runner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Runtime.create_runner</span></code></a> or <a class="reference internal" href="#furiosa.runtime.create_runner" title="furiosa.runtime.create_runner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_runner</span></code></a>.</p>
<p>This type is mainly used as a context manager:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">with</span> <span class="n">runtime</span><span class="o">.</span><span class="n">create_runner</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">runner</span><span class="p">:</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.Runner.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.Model" title="furiosa.runtime.Model"><span class="pre">Model</span></a></em><a class="headerlink" href="#furiosa.runtime.Runner.model" title="Permalink to this definition"></a></dt>
<dd><p>Informations about the associated model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">with</span> <span class="n">runtime</span><span class="o">.</span><span class="n">create_runner</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">runner</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">model</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">num_inputs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input tensor #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
<p>When the batch size is given,
the first dimension of all input and output tensors is multiplied by that batch size.
This dimension generally corresponds to the <a class="reference internal" href="#furiosa.runtime.Axis.BATCH" title="furiosa.runtime.Axis.BATCH"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BATCH</span></code></a> axis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Runner.run">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Runner.run" title="Permalink to this definition"></a></dt>
<dd><p>Runs a single inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<a class="reference internal" href="#furiosa.runtime.TensorArray" title="furiosa.runtime.TensorArray"><em>TensorArray</em></a>) – Input tensors</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)">numpy.ndarray</a>]</p>
</dd>
</dl>
<p>Input tensors are <strong>not</strong> copied to a new buffer.
Modifications during the inference may result in an unexpected output;
the runtime only ensures that such modifications do not cause a crash.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Runner.close">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Runner.close" title="Permalink to this definition"></a></dt>
<dd><p>Tries to close the session if not yet closed.
Waits until the session is indeed closed,
or it takes too much time to close (in which case the runtime may still be open).
If the session was created via the top-level <a class="reference internal" href="#furiosa.runtime.create_runner" title="furiosa.runtime.create_runner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_runner</span></code></a> function,
the implicitly initialized runtime is also closed as well.</p>
<p>The context manager internally calls this method at the end,
and warns when the timeout has been reached.
It is also called at the unspecified point after <a class="reference internal" href="#furiosa.runtime.Runner" title="furiosa.runtime.Runner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Runner</span></code></a> is subject to the garbage collection.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="code docutils literal notranslate"><span class="pre">True</span></code> if the session (and the runtime if any) has been closed in time.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p>Synchronous versions of those interfaces are also available through <code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.sync</span></code>:</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.sync.furiosa.runtime.sync.Runtime.create_runner">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.sync.Runtime.</span></span><span class="sig-name descname"><span class="pre">create_runner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.sync.furiosa.runtime.sync.Runtime.create_runner" title="Permalink to this definition"></a></dt>
<dd><p>Synchronous version of <code class="xref py py-obj docutils literal notranslate"><span class="pre">Runtime.create_runner</span></code> above.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.sync.create_runner">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.sync.</span></span><span class="sig-name descname"><span class="pre">create_runner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.sync.create_runner" title="Permalink to this definition"></a></dt>
<dd><p>Synchronous version of <a class="reference internal" href="#furiosa.runtime.create_runner" title="furiosa.runtime.create_runner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_runner</span></code></a> above.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.sync.Runner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.sync.</span></span><span class="sig-name descname"><span class="pre">Runner</span></span><a class="headerlink" href="#furiosa.runtime.sync.Runner" title="Permalink to this definition"></a></dt>
<dd><p>Synchronous version of <a class="reference internal" href="#furiosa.runtime.Runner" title="furiosa.runtime.Runner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Runner</span></code></a> above.</p>
</dd></dl>

<section id="legacy-runner-api">
<span id="id9"></span><h3>Legacy Interface<a class="headerlink" href="#legacy-runner-api" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.session.create">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.session.</span></span><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compiler_hints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.session.create" title="Permalink to this definition"></a></dt>
<dd><p>Compiles given model if needed, allocate an NPU device, and initializes a new inference session.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#furiosa.runtime.ModelSource" title="furiosa.runtime.ModelSource"><em>ModelSource</em></a>) – Model path or data</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><em>None</em>) – A textual <a class="reference internal" href="#device-specification">device specification</a>, see the section for defaults</p></li>
<li><p><strong>worker_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><em>None</em>) – The number of worker threads</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><em>None</em>) – The number of batches per each run</p></li>
<li><p><strong>compiler_hints</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em> or </em><em>None</em>) – If <code class="code docutils literal notranslate"><span class="pre">True</span></code>, compiler prints additional hint messages</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#furiosa.runtime.session.Session" title="furiosa.runtime.session.Session">Session</a></p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.10: </span>All optional arguments are now keyword-only.
Positional arguments are still accepted and behave identically for now,
but will warn against the future incompatibility.</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.session.Session">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.session.</span></span><span class="sig-name descname"><span class="pre">Session</span></span><a class="headerlink" href="#furiosa.runtime.session.Session" title="Permalink to this definition"></a></dt>
<dd><p>An inference session returned by <a class="reference internal" href="#furiosa.runtime.session.create" title="furiosa.runtime.session.create"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create</span></code></a>.</p>
<p>This type is mainly used as a context manager:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</pre></div>
</div>
<aside class="topic">
<p class="topic-title">Model informations</p>
<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.session.Session.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.Model" title="furiosa.runtime.Model"><span class="pre">Model</span></a></em><a class="headerlink" href="#furiosa.runtime.session.Session.model" title="Permalink to this definition"></a></dt>
<dd><p>Informations about the associated model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">model</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">num_inputs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input tensor #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.</span></p>
</div>
</dd></dl>

<p>For the compatibility, all <a class="reference internal" href="#furiosa.runtime.Model" title="furiosa.runtime.Model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Model</span></code></a> properties and methods are
also directly available to <a class="reference internal" href="#furiosa.runtime.session.Session" title="furiosa.runtime.session.Session"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Session</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">num_inputs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input tensor #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">session</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.10: </span>This mode of operation is no longer preferred, use <a class="reference internal" href="#furiosa.runtime.session.Session.model" title="furiosa.runtime.session.Session.model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></a> instead.</p>
</div>
<p>When the batch size is given,
the first dimension of all input and output tensors is multiplied by that batch size.
This dimension generally corresponds to the <code class="xref py py-obj docutils literal notranslate"><span class="pre">BATCH</span></code> axis.</p>
</aside>
<aside class="topic">
<p class="topic-title">Inference</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.session.Session.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.session.Session.run" title="Permalink to this definition"></a></dt>
<dd><p>Runs a single inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<a class="reference internal" href="#legacy-tensorarray-as-input"><span class="std std-ref">any TensorArray-like types</span></a>) – Input tensors</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#furiosa.runtime.tensor.TensorArray" title="furiosa.runtime.tensor.TensorArray"><em>TensorArray</em></a></p>
</dd>
</dl>
<p>Unlike the current version,
input tensors are copied to a new buffer unless it’s a <a class="reference internal" href="#furiosa.runtime.tensor.TensorArray" title="furiosa.runtime.tensor.TensorArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TensorArray</span></code></a>,
in which case it should not be altered after it was sent to <a class="reference internal" href="#furiosa.runtime.session.Session.run" title="furiosa.runtime.session.Session.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.session.Session.run_with">
<span class="sig-name descname"><span class="pre">run_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.session.Session.run_with" title="Permalink to this definition"></a></dt>
<dd><p>Runs a single inference, but all tensors are referred with explicit names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em>) – Output tensor names</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><em>ndarray</em></a><em>]</em>) – Input tensors and their names</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of output tensors, in the specified order</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#furiosa.runtime.tensor.TensorArray" title="furiosa.runtime.tensor.TensorArray"><em>TensorArray</em></a></p>
</dd>
</dl>
<p>Input tensors are always copied to a new buffer.</p>
<p>This method doesn’t allow a partial input and all input tensors should be present.
However there can be as few as a single output tensor specified.</p>
</dd></dl>

</aside>
<aside class="topic">
<p class="topic-title">Miscellaneous</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.session.Session.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.session.Session.close" title="Permalink to this definition"></a></dt>
<dd><p>Tries to close the session if not yet closed.</p>
<p>The context manager internally calls this method at the end.
It is also called at the unspecified point after <a class="reference internal" href="#furiosa.runtime.session.Session" title="furiosa.runtime.session.Session"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Session</span></code></a> is subject to the garbage collection.</p>
</dd></dl>

</aside>
</dd></dl>

</section>
</section>
<section id="queue-api">
<span id="id10"></span><h2>Queue API<a class="headerlink" href="#queue-api" title="Permalink to this heading"></a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.</span></p>
</div>
<p>Queue APIs provide two objects <a class="reference internal" href="#furiosa.runtime.Submitter" title="furiosa.runtime.Submitter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Submitter</span></code></a> and <a class="reference internal" href="#furiosa.runtime.Receiver" title="furiosa.runtime.Receiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Receiver</span></code></a> for separately handling inputs and outputs.
These are named so because they represent two queues around the actual processing:</p>
<dl class="simple glossary">
<dt id="term-Input-queue">Input queue<a class="headerlink" href="#term-Input-queue" title="Permalink to this term"></a></dt><dd><p>Holds submitted input tensors until some worker is available and can process them.</p>
</dd>
<dt id="term-Output-queue">Output queue<a class="headerlink" href="#term-Output-queue" title="Permalink to this term"></a></dt><dd><p>Holds output tensors that have been completed processed but not yet read.</p>
</dd>
</dl>
<p>Both have a configurable but finite size,
so submitting inputs too quickly or failing to receive outputs in time will block further processing.</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.furiosa.runtime.Runtime.create_queue">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.Runtime.</span></span><span class="sig-name descname"><span class="pre">create_queue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_queue_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_queue_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.furiosa.runtime.Runtime.create_queue" title="Permalink to this definition"></a></dt>
<dd><p>Creates a new inference session for given model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#furiosa.runtime.ModelSource" title="furiosa.runtime.ModelSource"><em>ModelSource</em></a>) – Model path or data</p></li>
<li><p><strong>worker_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><em>None</em>) – The number of worker threads</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><em>None</em>) – The number of batches per each run</p></li>
<li><p><strong>input_queue_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><em>None</em>) – The <a class="reference internal" href="#term-Input-queue"><span class="xref std std-term">input queue</span></a> size</p></li>
<li><p><strong>output_queue_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><em>None</em>) – The <a class="reference internal" href="#term-Output-queue"><span class="xref std std-term">output queue</span></a> size</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>[<a class="reference internal" href="#furiosa.runtime.Submitter" title="furiosa.runtime.Submitter">Submitter</a>, <a class="reference internal" href="#furiosa.runtime.Receiver" title="furiosa.runtime.Receiver">Receiver</a>], but see below</p>
</dd>
</dl>
<p>It is also possible to call this function directly as an asynchronous context manager:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">with</span> <span class="n">runtime</span><span class="o">.</span><span class="n">create_queue</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">,</span>
                                <span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">submitter</span><span class="p">,</span> <span class="n">receiver</span><span class="p">):</span>
    <span class="n">submit_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">submit_with</span><span class="p">(</span><span class="n">submitter</span><span class="p">))</span>
    <span class="n">recv_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv_with</span><span class="p">(</span><span class="n">receiver</span><span class="p">))</span>
    <span class="k">await</span> <span class="n">submit_task</span>
    <span class="k">await</span> <span class="n">recv_task</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.create_queue">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">create_queue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_queue_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_queue_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.create_queue" title="Permalink to this definition"></a></dt>
<dd><p>Same as above, but the runtime is implicitly created and
will be closed when the session couldn’t be created or gets closed.</p>
<p>See <a class="reference internal" href="#furiosa.runtime.furiosa.runtime.Runtime.create_queue" title="furiosa.runtime.furiosa.runtime.Runtime.create_queue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_queue</span></code></a> and <a class="reference internal" href="#furiosa.runtime.Runtime" title="furiosa.runtime.Runtime"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Runtime</span></code></a> for arguments.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.Submitter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">Submitter</span></span><a class="headerlink" href="#furiosa.runtime.Submitter" title="Permalink to this definition"></a></dt>
<dd><p>A submitting half of the inference session
returned by <a class="reference internal" href="#furiosa.runtime.furiosa.runtime.Runtime.create_queue" title="furiosa.runtime.furiosa.runtime.Runtime.create_queue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Runtime.create_queue</span></code></a> or <a class="reference internal" href="#furiosa.runtime.create_queue" title="furiosa.runtime.create_queue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_queue</span></code></a>.</p>
<p>This type is mainly used as a context manager:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">submitter</span><span class="p">,</span> <span class="n">receiver</span> <span class="o">=</span> <span class="k">await</span> <span class="n">runtime</span><span class="o">.</span><span class="n">create_queue</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">submitter</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">submitter</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">receiver</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">receiver</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.Submitter.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.Model" title="furiosa.runtime.Model"><span class="pre">Model</span></a></em><a class="headerlink" href="#furiosa.runtime.Submitter.model" title="Permalink to this definition"></a></dt>
<dd><p>Informations about the associated model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">submitter</span><span class="p">,</span> <span class="n">receiver</span> <span class="o">=</span> <span class="k">await</span> <span class="n">runtime</span><span class="o">.</span><span class="n">create_queue</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">submitter</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">submitter</span><span class="o">.</span><span class="n">model</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">num_inputs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input tensor #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
<p>When the batch size is given,
the first dimension of all input and output tensors is multiplied by that batch size.
This dimension generally corresponds to the <a class="reference internal" href="#furiosa.runtime.Axis.BATCH" title="furiosa.runtime.Axis.BATCH"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BATCH</span></code></a> axis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Submitter.allocate">
<span class="sig-name descname"><span class="pre">allocate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Submitter.allocate" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of fresh tensors, suitable as input tensors.
Their initial contents are not specified (but probably zeroed).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)">numpy.ndarray</a>]</p>
</dd>
</dl>
<p>While this is no different than creating tensors yourself,
the runtime may allocate tensors in the device-friendly way
so it is recommended to use this method whenever appropriate.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Submitter.submit">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">submit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Submitter.submit" title="Permalink to this definition"></a></dt>
<dd><p>Submits a single inference with an associated value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<a class="reference internal" href="#furiosa.runtime.TensorArray" title="furiosa.runtime.TensorArray"><em>TensorArray</em></a>) – Input tensors</p></li>
<li><p><strong>context</strong> – Associated value, to distinguish output tensors from <a class="reference internal" href="#furiosa.runtime.Receiver" title="furiosa.runtime.Receiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Receiver</span></code></a></p></li>
</ul>
</dd>
</dl>
<p>The method will return immediately,
unless the <a class="reference internal" href="#term-Input-queue"><span class="xref std std-term">input queue</span></a> is full in which case the method will be blocked.
Output tensors would be available through <a class="reference internal" href="#furiosa.runtime.Receiver" title="furiosa.runtime.Receiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Receiver</span></code></a> later.</p>
<p>Input tensors are <strong>not</strong> copied to a new buffer.
Modifications during the inference may result in an unexpected output;
the runtime only ensures that such modifications do not cause a crash.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Associated values should be simple values like an integer or a <a class="reference external" href="https://docs.python.org/3/library/uuid.html#uuid.uuid4" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UUID</span></code></a>,
as they are retained as long as a progress can be made and can cause logical memory leaks.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Submitter.close">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Submitter.close" title="Permalink to this definition"></a></dt>
<dd><p>Tries to close the submitter if not yet closed.
Waits until the submitter is indeed closed, or it takes too much time to close.</p>
<p>This does <em>not</em> close the corresponding <a class="reference internal" href="#furiosa.runtime.Receiver" title="furiosa.runtime.Receiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Receiver</span></code></a>.
Any remaining tensors in the <a class="reference internal" href="#term-Input-queue"><span class="xref std std-term">input queue</span></a> will be processed nevertheless,
and then the <a class="reference internal" href="#term-Output-queue"><span class="xref std std-term">output queue</span></a> will be signaled that no more results would be returned.</p>
<p>The context manager internally calls this method at the end,
and warns when the timeout has been reached.
It is also called at the unspecified point after <a class="reference internal" href="#furiosa.runtime.Submitter" title="furiosa.runtime.Submitter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Submitter</span></code></a> is subject to the garbage collection.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="code docutils literal notranslate"><span class="pre">True</span></code> if the submitter has been closed in time.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.Receiver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">Receiver</span></span><a class="headerlink" href="#furiosa.runtime.Receiver" title="Permalink to this definition"></a></dt>
<dd><p>A receiving half of the inference session
returned by <a class="reference internal" href="#furiosa.runtime.furiosa.runtime.Runtime.create_queue" title="furiosa.runtime.furiosa.runtime.Runtime.create_queue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Runtime.create_queue</span></code></a> or <a class="reference internal" href="#furiosa.runtime.create_queue" title="furiosa.runtime.create_queue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_queue</span></code></a>.</p>
<p>This type is mainly used as a context manager:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">submitter</span><span class="p">,</span> <span class="n">receiver</span> <span class="o">=</span> <span class="k">await</span> <span class="n">runtime</span><span class="o">.</span><span class="n">create_queue</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">submitter</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">submitter</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">receiver</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">receiver</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.Receiver.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.Model" title="furiosa.runtime.Model"><span class="pre">Model</span></a></em><a class="headerlink" href="#furiosa.runtime.Receiver.model" title="Permalink to this definition"></a></dt>
<dd><p>Informations about the associated model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">submitter</span><span class="p">,</span> <span class="n">receiver</span> <span class="o">=</span> <span class="k">await</span> <span class="n">runtime</span><span class="o">.</span><span class="n">create_queue</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">receiver</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">model</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">num_outputs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output tensor #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
<p>The same remarks to <a class="reference internal" href="#furiosa.runtime.Submitter" title="furiosa.runtime.Submitter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Submitter</span></code></a> apply when the batch size is given.</p>
</dd></dl>

<p>The type can be used as an asynchronous iterable,
which only finishes when either the corresponding <a class="reference internal" href="#furiosa.runtime.Submitter" title="furiosa.runtime.Submitter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Submitter</span></code></a> or the receiver itself has been closed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">submitter</span><span class="p">,</span> <span class="n">receiver</span> <span class="o">=</span> <span class="k">await</span> <span class="n">runtime</span><span class="o">.</span><span class="n">create_async</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span>
<span class="n">task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">submit_task</span><span class="p">(</span><span class="n">submitter</span><span class="p">))</span>
<span class="k">async</span> <span class="k">for</span> <span class="n">context</span><span class="p">,</span> <span class="n">outputs</span> <span class="ow">in</span> <span class="n">receiver</span><span class="p">:</span>
    <span class="n">handle_output</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that in this usage a <code class="code docutils literal notranslate"><span class="pre">async</span> <span class="pre">with</span></code> block is not strictly needed
as <a class="reference internal" href="#furiosa.runtime.Submitter" title="furiosa.runtime.Submitter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Submitter</span></code></a> should have been already closed when the loop finishes.</p>
<p>It is also possible to manually receive results:</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Receiver.recv">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">recv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Receiver.recv" title="Permalink to this definition"></a></dt>
<dd><p>Waits for a single inference result, and returns it with the associated value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple of the associated value and output tensors, in this order</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>[any, <a class="reference internal" href="#furiosa.runtime.tensor.TensorArray" title="furiosa.runtime.tensor.TensorArray"><em>TensorArray</em></a>]</p>
</dd>
</dl>
<p>The runtime guarantees that each inference result is received at most once,
but the completion order may differ from the submission order.
Put the associated value to <a class="reference internal" href="#furiosa.runtime.Submitter.submit" title="furiosa.runtime.Submitter.submit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Submitter.submit</span></code></a> to recover the original order.</p>
<p>Multiple parallel <a class="reference internal" href="#furiosa.runtime.Receiver.recv" title="furiosa.runtime.Receiver.recv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recv</span></code></a> calls are fine but do not have additional benefits.
On the other hands, if no <a class="reference internal" href="#furiosa.runtime.Receiver.recv" title="furiosa.runtime.Receiver.recv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recv</span></code></a> calls are made for a while,
the <a class="reference internal" href="#term-Output-queue"><span class="xref std std-term">output queue</span></a> eventually fills up and would block any further processing.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method does not support <code class="docutils literal notranslate"><span class="pre">timeout</span></code> unlike others,
because <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#asyncio.wait_for" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">asyncio.wait_for</span></code></a> provides an idiomatic way to do that:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">recv</span><span class="p">():</span>
        <span class="n">context</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">receiver</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

    <span class="n">task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="p">())</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>  <span class="c1"># Not the built-in `TimeoutError`!</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Timed out!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.Receiver.close">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.Receiver.close" title="Permalink to this definition"></a></dt>
<dd><p>Tries to close the receiver if not yet closed.
This also notifies the corresponding <a class="reference internal" href="#furiosa.runtime.Submitter" title="furiosa.runtime.Submitter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Submitter</span></code></a> and will block further submissions.
Waits until the receiver is indeed closed, or it takes too much time to close.</p>
<p>If the receiver was created via the top-level <a class="reference internal" href="#furiosa.runtime.create_queue" title="furiosa.runtime.create_queue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_queue</span></code></a> function,
the implicitly initialized runtime is also closed as well.</p>
<p>The context manager internally calls this method at the end,
and warns when the timeout has been reached.
It is also called at the unspecified point after <a class="reference internal" href="#furiosa.runtime.Receiver" title="furiosa.runtime.Receiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Receiver</span></code></a> is subject to the garbage collection.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="code docutils literal notranslate"><span class="pre">True</span></code> if the receiver (and the runtime if any) has been closed in time.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p>Synchronous versions of those interfaces are also available through <code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.sync</span></code>:</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.sync.furiosa.runtime.sync.Runtime.create_queue">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.sync.Runtime.</span></span><span class="sig-name descname"><span class="pre">create_queue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_queue_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_queue_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.sync.furiosa.runtime.sync.Runtime.create_queue" title="Permalink to this definition"></a></dt>
<dd><p>Synchronous version of <code class="xref py py-obj docutils literal notranslate"><span class="pre">Runtime.create_queue</span></code> above.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.sync.create_queue">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.sync.</span></span><span class="sig-name descname"><span class="pre">create_queue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_queue_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_queue_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.sync.create_queue" title="Permalink to this definition"></a></dt>
<dd><p>Synchronous version of <a class="reference internal" href="#furiosa.runtime.create_queue" title="furiosa.runtime.create_queue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_queue</span></code></a> above.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.sync.Submitter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.sync.</span></span><span class="sig-name descname"><span class="pre">Submitter</span></span><a class="headerlink" href="#furiosa.runtime.sync.Submitter" title="Permalink to this definition"></a></dt>
<dd><p>Synchronous version of <a class="reference internal" href="#furiosa.runtime.Submitter" title="furiosa.runtime.Submitter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Submitter</span></code></a> above.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.sync.Receiver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.sync.</span></span><span class="sig-name descname"><span class="pre">Receiver</span></span><a class="headerlink" href="#furiosa.runtime.sync.Receiver" title="Permalink to this definition"></a></dt>
<dd><p>Synchronous version of <a class="reference internal" href="#furiosa.runtime.Receiver" title="furiosa.runtime.Receiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Receiver</span></code></a> above, with the following exception:</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.sync.Receiver.recv">
<span class="sig-name descname"><span class="pre">recv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.sync.Receiver.recv" title="Permalink to this definition"></a></dt>
<dd><p>Unlike an asynchronous version,
this method <em>does</em> accept the timeout because it is otherwise impossible to specify the timeout in a synchronous context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em> or </em><em>None</em>) – The timeout in <em>seconds</em></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TimeoutError" title="(in Python v3.12)"><strong>TimeoutError</strong></a> – When <code class="docutils literal notranslate"><span class="pre">timeout</span></code> is given and the timeout has been reached</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike <code class="xref py py-obj docutils literal notranslate"><span class="pre">CompletionQueue.recv</span></code>, this method raises a standard Python exception.</p>
</div>
</dd></dl>

</dd></dl>

<section id="legacy-queue-api">
<span id="id11"></span><h3>Legacy Interface<a class="headerlink" href="#legacy-queue-api" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.session.create_async">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.session.</span></span><span class="sig-name descname"><span class="pre">create_async</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compiler_hints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_queue_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_queue_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.session.create_async" title="Permalink to this definition"></a></dt>
<dd><p>Compiles given model if needed, allocate an NPU device, and initializes a new inference session.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#furiosa.runtime.ModelSource" title="furiosa.runtime.ModelSource"><em>ModelSource</em></a>) – Model path or data</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><em>None</em>) – A textual <a class="reference internal" href="#device-specification">device specification</a>, see the section for defaults</p></li>
<li><p><strong>worker_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><em>None</em>) – The number of worker threads</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><em>None</em>) – The number of batches per each run</p></li>
<li><p><strong>compiler_hints</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em> or </em><em>None</em>) – If <code class="code docutils literal notranslate"><span class="pre">True</span></code>, compiler prints additional hint messages</p></li>
<li><p><strong>input_queue_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><em>None</em>) – The <a class="reference internal" href="#term-Input-queue"><span class="xref std std-term">input queue</span></a> size</p></li>
<li><p><strong>output_queue_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><em>None</em>) – The <a class="reference internal" href="#term-Output-queue"><span class="xref std std-term">output queue</span></a> size</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>[<a class="reference internal" href="#furiosa.runtime.session.AsyncSession" title="furiosa.runtime.session.AsyncSession">AsyncSession</a>, <a class="reference internal" href="#furiosa.runtime.session.CompletionQueue" title="furiosa.runtime.session.CompletionQueue">CompletionQueue</a>]</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.10: </span>All optional arguments are now keyword-only.
Positional arguments are still accepted and behave identically for now,
but will warn against the future incompatibility.</p>
</div>
<p><a class="reference internal" href="#use-of-legacy-modules"><span class="std std-ref">Legacy only</span></a>:
The input and output queue were unbounded when their sizes are not given.
This was never documented and the current API doesn’t support unbounded queues.
In order to faciliate migration, the legacy API will continue to use
much larger default queue sizes though.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.session.AsyncSession">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.session.</span></span><span class="sig-name descname"><span class="pre">AsyncSession</span></span><a class="headerlink" href="#furiosa.runtime.session.AsyncSession" title="Permalink to this definition"></a></dt>
<dd><p>A submitting half of the inference session returned by <a class="reference internal" href="#furiosa.runtime.session.create_async" title="furiosa.runtime.session.create_async"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_async</span></code></a>.</p>
<p>This type is mainly used as a context manager:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="p">,</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">create_async</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">session</span><span class="p">:</span>
    <span class="n">session</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="k">with</span> <span class="n">queue</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</pre></div>
</div>
<aside class="topic">
<p class="topic-title">Model informations</p>
<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.session.AsyncSession.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.Model" title="furiosa.runtime.Model"><span class="pre">Model</span></a></em><a class="headerlink" href="#furiosa.runtime.session.AsyncSession.model" title="Permalink to this definition"></a></dt>
<dd><p>Informations about the associated model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="p">,</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">create_async</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">session</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">model</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">num_inputs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input tensor #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.</span></p>
</div>
</dd></dl>

<p>For the compatibility, all <a class="reference internal" href="#furiosa.runtime.Model" title="furiosa.runtime.Model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Model</span></code></a> properties and methods are
also directly available to <a class="reference internal" href="#furiosa.runtime.session.AsyncSession" title="furiosa.runtime.session.AsyncSession"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AsyncSession</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="p">,</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">create_async</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">session</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">num_inputs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input tensor #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">session</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.10: </span>This mode of operation is no longer preferred, use <a class="reference internal" href="#furiosa.runtime.session.AsyncSession.model" title="furiosa.runtime.session.AsyncSession.model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></a> instead.</p>
</div>
<p>When the batch size is given,
the first dimension of all input and output tensors is multiplied by that batch size.
This dimension generally corresponds to the <code class="xref py py-obj docutils literal notranslate"><span class="pre">BATCH</span></code> axis.</p>
</aside>
<aside class="topic">
<p class="topic-title">Submitting</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.session.AsyncSession.submit">
<span class="sig-name descname"><span class="pre">submit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.session.AsyncSession.submit" title="Permalink to this definition"></a></dt>
<dd><p>Submits a single inference with an associated value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<a class="reference internal" href="#legacy-tensorarray-as-input"><span class="std std-ref">any TensorArray-like types</span></a>) – Input tensors</p></li>
<li><p><strong>context</strong> – Associated value, to distinguish output tensors from <a class="reference internal" href="#furiosa.runtime.session.CompletionQueue" title="furiosa.runtime.session.CompletionQueue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CompletionQueue</span></code></a></p></li>
</ul>
</dd>
</dl>
<p>The method will return immediately,
unless the <a class="reference internal" href="#term-Input-queue"><span class="xref std std-term">input queue</span></a> is full in which case the method will be blocked.
Output tensors would be available through <a class="reference internal" href="#furiosa.runtime.session.CompletionQueue" title="furiosa.runtime.session.CompletionQueue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CompletionQueue</span></code></a> later.</p>
<p>Unlike the current version,
input tensors are copied to a new buffer unless it’s a <a class="reference internal" href="#furiosa.runtime.tensor.TensorArray" title="furiosa.runtime.tensor.TensorArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TensorArray</span></code></a>,
in which case it should not be altered after it was sent to <a class="reference internal" href="#furiosa.runtime.session.AsyncSession.submit" title="furiosa.runtime.session.AsyncSession.submit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">submit</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Associated values should be simple values like an integer or a <a class="reference external" href="https://docs.python.org/3/library/uuid.html#uuid.uuid4" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UUID</span></code></a>,
as they are retained as long as a progress can be made and cause logical memory leaks.</p>
</div>
</dd></dl>

</aside>
<aside class="topic">
<p class="topic-title">Miscellaneous</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.session.AsyncSession.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.session.AsyncSession.close" title="Permalink to this definition"></a></dt>
<dd><p>Tries to close the session if not yet closed.</p>
<p>This does <em>not</em> close the corresponding <a class="reference internal" href="#furiosa.runtime.session.CompletionQueue" title="furiosa.runtime.session.CompletionQueue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CompletionQueue</span></code></a>.
Any remaining tensors in the <a class="reference internal" href="#term-Input-queue"><span class="xref std std-term">input queue</span></a> will be processed nevertheless,
and then the <a class="reference internal" href="#term-Output-queue"><span class="xref std std-term">output queue</span></a> will be signaled that no more results would be returned.</p>
<p>The context manager internally calls this method at the end.
It is also called at the unspecified point after <a class="reference internal" href="#furiosa.runtime.session.AsyncSession" title="furiosa.runtime.session.AsyncSession"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AsyncSession</span></code></a> is subject to the garbage collection.</p>
</dd></dl>

</aside>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.session.CompletionQueue">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.session.</span></span><span class="sig-name descname"><span class="pre">CompletionQueue</span></span><a class="headerlink" href="#furiosa.runtime.session.CompletionQueue" title="Permalink to this definition"></a></dt>
<dd><p>A receiving half of the inference session returned by <a class="reference internal" href="#furiosa.runtime.session.create_async" title="furiosa.runtime.session.create_async"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_async</span></code></a>.</p>
<p>This type is mainly used as a context manager:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="p">,</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">create_async</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">session</span><span class="p">:</span>
    <span class="n">session</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="k">with</span> <span class="n">queue</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</pre></div>
</div>
<aside class="topic">
<p class="topic-title">Model informations</p>
<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.session.CompletionQueue.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.Model" title="furiosa.runtime.Model"><span class="pre">Model</span></a></em><a class="headerlink" href="#furiosa.runtime.session.CompletionQueue.model" title="Permalink to this definition"></a></dt>
<dd><p>Informations about the associated model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="p">,</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">create_async</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">queue</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">model</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">num_outputs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output tensor #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.</span></p>
</div>
</dd></dl>

<p>For the compatibility, all <a class="reference internal" href="#furiosa.runtime.Model" title="furiosa.runtime.Model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Model</span></code></a> properties and methods are
also directly available to <a class="reference internal" href="#furiosa.runtime.session.CompletionQueue" title="furiosa.runtime.session.CompletionQueue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CompletionQueue</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="p">,</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">create_async</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">queue</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">queue</span><span class="o">.</span><span class="n">num_outputs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output tensor #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">queue</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.10: </span>This mode of operation is no longer preferred, use <a class="reference internal" href="#furiosa.runtime.session.CompletionQueue.model" title="furiosa.runtime.session.CompletionQueue.model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></a> instead.</p>
</div>
<p>The same remarks to <a class="reference internal" href="#furiosa.runtime.session.AsyncSession" title="furiosa.runtime.session.AsyncSession"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AsyncSession</span></code></a> apply when the batch size is given.</p>
</aside>
<aside class="topic">
<p class="topic-title">Receiving</p>
<p>The type can be used as an iterable,
which only finishes when either the corresponding <a class="reference internal" href="#furiosa.runtime.session.AsyncSession" title="furiosa.runtime.session.AsyncSession"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AsyncSession</span></code></a> or the queue itself has been closed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="p">,</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">create_async</span><span class="p">(</span><span class="s2">&quot;path/to/model.onnx&quot;</span><span class="p">)</span>
<span class="n">spawn_thread_to_send_inputs</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
<span class="k">for</span> <span class="n">context</span><span class="p">,</span> <span class="n">outputs</span> <span class="ow">in</span> <span class="n">queue</span><span class="p">:</span>
    <span class="n">handle_output</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that in this usage a <code class="code docutils literal notranslate"><span class="pre">with</span></code> block is not strictly needed
as <a class="reference internal" href="#furiosa.runtime.session.AsyncSession" title="furiosa.runtime.session.AsyncSession"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AsyncSession</span></code></a> should have been already closed when the loop finishes.</p>
<p>It is also possible to manually receive results:</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.session.CompletionQueue.recv">
<span class="sig-name descname"><span class="pre">recv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.session.CompletionQueue.recv" title="Permalink to this definition"></a></dt>
<dd><p>Waits for a single inference result, and returns it with the associated value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><em>None</em>) – The timeout in <em>milliseconds</em></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of the associated value and output tensors, in this order</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>[any, <a class="reference internal" href="#furiosa.runtime.tensor.TensorArray" title="furiosa.runtime.tensor.TensorArray"><em>TensorArray</em></a>]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#furiosa.runtime.errors.QueueWaitTimeout" title="furiosa.runtime.errors.QueueWaitTimeout"><strong>QueueWaitTimeout</strong></a> – When <code class="docutils literal notranslate"><span class="pre">timeout</span></code> is given and the timeout has been reached</p>
</dd>
</dl>
<p>The runtime guarantees that each inference result is received at most once,
but the completion order may differ from the submission order.
Put the associated value to <a class="reference internal" href="#furiosa.runtime.session.AsyncSession.submit" title="furiosa.runtime.session.AsyncSession.submit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AsyncSession.submit</span></code></a> to recover the original order.</p>
<p>Multiple parallel <a class="reference internal" href="#furiosa.runtime.session.CompletionQueue.recv" title="furiosa.runtime.session.CompletionQueue.recv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recv</span></code></a> calls are fine but do not have additional benefits.
On the other hands, if no <a class="reference internal" href="#furiosa.runtime.session.CompletionQueue.recv" title="furiosa.runtime.session.CompletionQueue.recv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recv</span></code></a> calls are made for a while,
the <a class="reference internal" href="#term-Output-queue"><span class="xref std std-term">output queue</span></a> eventually fills up and would block any further processing.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.10: </span>The millisecond convention for <code class="docutils literal notranslate"><span class="pre">timeout</span></code> is not Pythonic and prone to error.
<a class="reference internal" href="#furiosa.runtime.Receiver" title="furiosa.runtime.Receiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Receiver</span></code></a> uses seconds instead,
so this method will now warn for the potential future incompatibillity.</p>
</div>
</dd></dl>

</aside>
<aside class="topic">
<p class="topic-title">Miscellaneous</p>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.session.CompletionQueue.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.session.CompletionQueue.close" title="Permalink to this definition"></a></dt>
<dd><p>Tries to close the completion queue if not yet closed.
This also notifies the corresponding <a class="reference internal" href="#furiosa.runtime.session.AsyncSession" title="furiosa.runtime.session.AsyncSession"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AsyncSession</span></code></a> and will block further submissions.</p>
<p>The context manager internally calls this method at the end.
It is also called at the unspecified point after <a class="reference internal" href="#furiosa.runtime.session.CompletionQueue" title="furiosa.runtime.session.CompletionQueue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CompletionQueue</span></code></a> is subject to the garbage collection.</p>
</dd></dl>

</aside>
</dd></dl>

</section>
</section>
<section id="profiler">
<span id="id12"></span><h2>Profiler<a class="headerlink" href="#profiler" title="Permalink to this heading"></a></h2>
<span class="target" id="module-furiosa.runtime.profiler"></span><p>The <a class="reference internal" href="#module-furiosa.runtime.profiler" title="furiosa.runtime.profiler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">furiosa.runtime.profiler</span></code></a> module provides a basic <a class="reference internal" href="../../software/profiler.html#profiling"><span class="std std-ref">profiling</span></a> facility.</p>
<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.RecordFormat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.profiler.</span></span><span class="sig-name descname"><span class="pre">RecordFormat</span></span><a class="headerlink" href="#furiosa.runtime.profiler.RecordFormat" title="Permalink to this definition"></a></dt>
<dd><p>Profiler format to record profile data.</p>
<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.RecordFormat.ChromeTrace">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ChromeTrace</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.profiler.RecordFormat" title="furiosa.runtime.profiler.RecordFormat"><span class="pre">RecordFormat</span></a></em><a class="headerlink" href="#furiosa.runtime.profiler.RecordFormat.ChromeTrace" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.profiler.RecordFormat.PandasDataFrame">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PandasDataFrame</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.profiler.RecordFormat" title="furiosa.runtime.profiler.RecordFormat"><span class="pre">RecordFormat</span></a></em><a class="headerlink" href="#furiosa.runtime.profiler.RecordFormat.PandasDataFrame" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.Resource">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.profiler.</span></span><span class="sig-name descname"><span class="pre">Resource</span></span><a class="headerlink" href="#furiosa.runtime.profiler.Resource" title="Permalink to this definition"></a></dt>
<dd><p>Profiler target resource to be recorded.</p>
<dl class="py property">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.Resource.All">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">All</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.profiler.Resource" title="furiosa.runtime.profiler.Resource"><span class="pre">Resource</span></a></em><a class="headerlink" href="#furiosa.runtime.profiler.Resource.All" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.profiler.Resource.Cpu">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Cpu</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.profiler.Resource" title="furiosa.runtime.profiler.Resource"><span class="pre">Resource</span></a></em><a class="headerlink" href="#furiosa.runtime.profiler.Resource.Cpu" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.profiler.Resource.Npu">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Npu</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#furiosa.runtime.profiler.Resource" title="furiosa.runtime.profiler.Resource"><span class="pre">Resource</span></a></em><a class="headerlink" href="#furiosa.runtime.profiler.Resource.Npu" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.profiler.</span></span><span class="sig-name descname"><span class="pre">profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Resource.All</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">RecordFormat.ChromeTrace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile" title="Permalink to this definition"></a></dt>
<dd><p>Profile context manager:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">furiosa.runtime.profiler</span> <span class="kn">import</span> <span class="n">RecordFormat</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;profile.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">profile</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="n">RecordFormat</span><span class="o">.</span><span class="n">ChromeTrace</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span> <span class="k">as</span> <span class="n">profiler</span><span class="p">:</span>
        <span class="c1"># Profiler enabled from here</span>
        <span class="k">with</span> <span class="n">profiler</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="s2">&quot;Inference&quot;</span><span class="p">):</span>
            <span class="o">...</span> <span class="c1"># Profiler recorded with span named &#39;Inference&#39;</span>
</pre></div>
</div>
<p>Please note that activating profiler incurs non-trivial performance overhead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource</strong> (<a class="reference internal" href="#furiosa.runtime.profiler.Resource" title="furiosa.runtime.profiler.Resource"><em>Resource</em></a>) – Target resource to be profiled. e.g. <a class="reference internal" href="#furiosa.runtime.profiler.Resource.Cpu" title="furiosa.runtime.profiler.Resource.Cpu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cpu</span></code></a> or <a class="reference internal" href="#furiosa.runtime.profiler.Resource.Npu" title="furiosa.runtime.profiler.Resource.Npu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Npu</span></code></a>.</p></li>
<li><p><strong>format</strong> (<a class="reference internal" href="#furiosa.runtime.profiler.RecordFormat" title="furiosa.runtime.profiler.RecordFormat"><em>RecordFormat</em></a>) – Profiler format. e.g. ChromeTrace.</p></li>
<li><p><strong>file</strong> – File that traces will be written to. If the file is not given, temporary file will be used. Format of traces writter to the file depends on the record format: Chrome tracing for <a class="reference internal" href="#furiosa.runtime.profiler.RecordFormat.ChromeTrace" title="furiosa.runtime.profiler.RecordFormat.ChromeTrace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ChromeTrace</span></code></a> and CSV for <a class="reference internal" href="#furiosa.runtime.profiler.RecordFormat.PandasDataFrame" title="furiosa.runtime.profiler.RecordFormat.PandasDataFrame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PandasDataFrame</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>runtime.ProfilerErorr</strong> – Raise when failed to create profiler with given configuration.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.10.0: </span>Record format-dependent parameter <code class="xref py py-obj docutils literal notranslate"><span class="pre">config</span></code> is replaced by parameter <code class="xref py py-obj docutils literal notranslate"><span class="pre">file</span></code>.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile.record">
<span class="sig-name descname"><span class="pre">record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile.record" title="Permalink to this definition"></a></dt>
<dd><p>Returns a profiler record context manager.</p>
<p>At the enter of the context, profiler span trace with specified name starts, and ends at the exit of the context.
Traces for execution within the context will be recorded as a child of the created span.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Profiler record span name.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ProfilerRecordObject</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile.pause">
<span class="sig-name descname"><span class="pre">pause</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile.pause" title="Permalink to this definition"></a></dt>
<dd><p>Pause profiling temporarily within the profiling context.</p>
<p>Profiler stops recording traces and works with minimal overhead until <a class="reference internal" href="#furiosa.runtime.profiler.profile.resume" title="furiosa.runtime.profiler.profile.resume"><code class="xref py py-obj docutils literal notranslate"><span class="pre">resume</span></code></a> is called.
If the profiler is already in a paused state, it does nothing.
This method can be called arbitrary number of times within the profiling context.
Note that this method doesn’t affect the time measurment of the profiler, meaning that it just acts as if no events occured during pause, creating empty interval.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile.resume">
<span class="sig-name descname"><span class="pre">resume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile.resume" title="Permalink to this definition"></a></dt>
<dd><p>Resume paused profiling.</p>
<p>If the profiler is not in a paused state, this method does nothing.
For more details on paused state, see <a class="reference internal" href="#furiosa.runtime.profiler.profile.pause" title="furiosa.runtime.profiler.profile.pause"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pause</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile.get_pandas_dataframe">
<span class="sig-name descname"><span class="pre">get_pandas_dataframe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile.get_pandas_dataframe" title="Permalink to this definition"></a></dt>
<dd><p>Returns a <code class="xref py py-obj docutils literal notranslate"><span class="pre">DataFrame</span></code> for recorded traces.</p>
<p>The returned dataframe will look like:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="w">                            </span>trace_id<span class="w">    </span>parent_span_id<span class="w">           </span>span_id<span class="w">                </span>start<span class="w">                  </span>end<span class="w">      </span>cat<span class="w">                     </span>name<span class="w">  </span>thread.id<span class="w">  </span>dram_base<span class="w">  </span>pe_index<span class="w">  </span>execution_index<span class="w">  </span>instruction_index<span class="w">  </span>operator_index<span class="w">        </span>dur
<span class="m">0</span><span class="w">    </span>6ffe9ac3080814bc134ae4c5e58269e0<span class="w">  </span><span class="m">0000000000000000</span><span class="w">  </span>a61dd01a47ce8dee<span class="w">  </span><span class="m">1690798389820453606</span><span class="w">  </span><span class="m">1690798390204660478</span><span class="w">  </span>Runtime<span class="w">                  </span>Compile<span class="w">         </span><span class="m">35</span><span class="w">       </span>&lt;NA&gt;<span class="w">      </span>&lt;NA&gt;<span class="w">             </span>&lt;NA&gt;<span class="w">               </span>&lt;NA&gt;<span class="w">            </span>&lt;NA&gt;<span class="w">  </span><span class="m">384206872</span>
<span class="m">1</span><span class="w">    </span>079f8437488528d5768780162ed59374<span class="w">  </span><span class="m">0000000000000000</span><span class="w">  </span>2d18b0e17e760325<span class="w">  </span><span class="m">1690798390205840825</span><span class="w">  </span><span class="m">1690798390267819096</span><span class="w">  </span>Runtime<span class="w">            </span>ProgramBinary<span class="w">         </span><span class="m">26</span><span class="w">       </span>&lt;NA&gt;<span class="w">      </span>&lt;NA&gt;<span class="w">             </span>&lt;NA&gt;<span class="w">               </span>&lt;NA&gt;<span class="w">            </span>&lt;NA&gt;<span class="w">   </span><span class="m">61978271</span>
<span class="m">2</span><span class="w">    </span>fb4610c2fd1be67e63e01ca9169b6fef<span class="w">  </span><span class="m">0000000000000000</span><span class="w">  </span>2a092524d04a4077<span class="w">  </span><span class="m">1690798390267849007</span><span class="w">  </span><span class="m">1690798390267857471</span><span class="w">  </span>Runtime<span class="w">             </span>AllocateDram<span class="w">         </span><span class="m">26</span><span class="w">       </span>&lt;NA&gt;<span class="w">      </span>&lt;NA&gt;<span class="w">             </span>&lt;NA&gt;<span class="w">               </span>&lt;NA&gt;<span class="w">            </span>&lt;NA&gt;<span class="w">       </span><span class="m">8464</span>
<span class="m">3</span><span class="w">    </span>009b425f06ca0065a64f0586d1a999b0<span class="w">  </span><span class="m">0000000000000000</span><span class="w">  </span>cdac229f8d8569d7<span class="w">  </span><span class="m">1690798389793627190</span><span class="w">  </span><span class="m">1690798390268011450</span><span class="w">  </span>Runtime<span class="w">                 </span>Register<span class="w">          </span><span class="m">1</span><span class="w">       </span>&lt;NA&gt;<span class="w">      </span>&lt;NA&gt;<span class="w">             </span>&lt;NA&gt;<span class="w">               </span>&lt;NA&gt;<span class="w">            </span>&lt;NA&gt;<span class="w">  </span><span class="m">474384260</span>
<span class="m">4</span><span class="w">    </span>348ee82fdf97fad9f782cc12a58d447d<span class="w">  </span><span class="m">0000000000000000</span><span class="w">  </span>59b5a5d06439f9f1<span class="w">  </span><span class="m">1690798390270474367</span><span class="w">  </span><span class="m">1690798390270526470</span><span class="w">  </span>Runtime<span class="w">                  </span>Enqueue<span class="w">         </span><span class="m">32</span><span class="w">       </span>&lt;NA&gt;<span class="w">      </span>&lt;NA&gt;<span class="w">             </span>&lt;NA&gt;<span class="w">               </span>&lt;NA&gt;<span class="w">            </span>&lt;NA&gt;<span class="w">      </span><span class="m">52103</span>
<span class="m">5</span><span class="w">    </span>27efb2c82a5ac93bed911142e9187c45<span class="w">  </span>174b38c90d1f7a10<span class="w">  </span>ff7c4f8798d75b63<span class="w">  </span><span class="m">1690798390270558295</span><span class="w">  </span><span class="m">1690798390270570293</span><span class="w">  </span>Runtime<span class="w">               </span>FeedInputs<span class="w">         </span><span class="m">32</span><span class="w">       </span>&lt;NA&gt;<span class="w">      </span>&lt;NA&gt;<span class="w">             </span>&lt;NA&gt;<span class="w">               </span>&lt;NA&gt;<span class="w">            </span>&lt;NA&gt;<span class="w">      </span><span class="m">11998</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile.get_pandas_dataframe_with_filter">
<span class="sig-name descname"><span class="pre">get_pandas_dataframe_with_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile.get_pandas_dataframe_with_filter" title="Permalink to this definition"></a></dt>
<dd><p>Returns a DataFrame only containing rows whose column <code class="docutils literal notranslate"><span class="pre">column</span></code> has a value <code class="docutils literal notranslate"><span class="pre">value</span></code> in the DataFrame returned by <a class="reference internal" href="#furiosa.runtime.profiler.profile.get_pandas_dataframe" title="furiosa.runtime.profiler.profile.get_pandas_dataframe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_pandas_dataframe</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>column</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – name of the column used for filtering.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – column value for target rows.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile.get_cpu_pandas_dataframe">
<span class="sig-name descname"><span class="pre">get_cpu_pandas_dataframe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile.get_cpu_pandas_dataframe" title="Permalink to this definition"></a></dt>
<dd><p>Returns a <code class="xref py py-obj docutils literal notranslate"><span class="pre">DataFrame</span></code> for execution on CPU whose category is “Runtime”.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile.get_npu_pandas_dataframe">
<span class="sig-name descname"><span class="pre">get_npu_pandas_dataframe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile.get_npu_pandas_dataframe" title="Permalink to this definition"></a></dt>
<dd><p>Returns a <code class="xref py py-obj docutils literal notranslate"><span class="pre">DataFrame</span></code> for execution on NPU whose category is “NPU”.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile.print_npu_operators">
<span class="sig-name descname"><span class="pre">print_npu_operators</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile.print_npu_operators" title="Permalink to this definition"></a></dt>
<dd><p>Print npu operator report to the terminal.</p>
<p>Each row contains information for different NPU operator.</p>
<p>The output will look like:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>┌─────────────────────────┬──────────────────────┬───────┐
│<span class="w"> </span>name<span class="w">                    </span>┆<span class="w"> </span>average_elapsed<span class="w"> </span><span class="o">(</span>ns<span class="o">)</span><span class="w"> </span>┆<span class="w"> </span>count<span class="w"> </span>│
╞═════════════════════════╪══════════════════════╪═══════╡
│<span class="w"> </span>LowLevelConv2d<span class="w">          </span>┆<span class="w"> </span><span class="m">5119</span>.9375<span class="w">            </span>┆<span class="w"> </span><span class="m">64</span><span class="w">    </span>│
│<span class="w"> </span>LowLevelDepthwiseConv2d<span class="w"> </span>┆<span class="w"> </span><span class="m">1091</span>.0<span class="w">               </span>┆<span class="w"> </span><span class="m">56</span><span class="w">    </span>│
│<span class="w"> </span>LowLevelPad<span class="w">             </span>┆<span class="w"> </span><span class="m">561</span>.482143<span class="w">           </span>┆<span class="w"> </span><span class="m">56</span><span class="w">    </span>│
│<span class="w"> </span>LowLevelExpand<span class="w">          </span>┆<span class="w"> </span><span class="m">2</span>.0<span class="w">                  </span>┆<span class="w"> </span><span class="m">16</span><span class="w">    </span>│
│<span class="w"> </span>LowLevelSlice<span class="w">           </span>┆<span class="w"> </span><span class="m">2</span>.0<span class="w">                  </span>┆<span class="w"> </span><span class="m">16</span><span class="w">    </span>│
│<span class="w"> </span>LowLevelReshape<span class="w">         </span>┆<span class="w"> </span><span class="m">2</span>.0<span class="w">                  </span>┆<span class="w"> </span><span class="m">232</span><span class="w">   </span>│
└─────────────────────────┴──────────────────────┴───────┘
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile.print_npu_executions">
<span class="sig-name descname"><span class="pre">print_npu_executions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile.print_npu_executions" title="Permalink to this definition"></a></dt>
<dd><p>Print npu execution report to the terminal.
Each row contains information for each NPU task execution.</p>
<p>The output will look like:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>┌─────────────────┬─────────────────┬──────────┬────────────────┬───────────┬─────────┬────────────┐
│<span class="w"> </span>trace_id<span class="w">        </span>┆<span class="w"> </span>span_id<span class="w">         </span>┆<span class="w"> </span>pe_index<span class="w"> </span>┆<span class="w"> </span>execution_inde<span class="w"> </span>┆<span class="w"> </span>NPU<span class="w"> </span>Total<span class="w"> </span>┆<span class="w"> </span>NPU<span class="w"> </span>Run<span class="w"> </span>┆<span class="w"> </span>NPU<span class="w"> </span>IoWait<span class="w"> </span>│
│<span class="w">                 </span>┆<span class="w">                 </span>┆<span class="w">          </span>┆<span class="w"> </span>x<span class="w">              </span>┆<span class="w">           </span>┆<span class="w">         </span>┆<span class="w">            </span>│
╞═════════════════╪═════════════════╪══════════╪════════════════╪═══════════╪═════════╪════════════╡
│<span class="w"> </span>39ffc55ef7b2177<span class="w"> </span>┆<span class="w"> </span>555899badb3f8e5<span class="w"> </span>┆<span class="w"> </span><span class="m">0</span><span class="w">        </span>┆<span class="w"> </span><span class="m">0</span><span class="w">              </span>┆<span class="w"> </span><span class="m">116971</span><span class="w">    </span>┆<span class="w"> </span><span class="m">105186</span><span class="w">  </span>┆<span class="w"> </span><span class="m">11785</span><span class="w">      </span>│
│<span class="w"> </span>5338e9fa2d1fb70<span class="w"> </span>┆<span class="w"> </span><span class="m">8</span><span class="w">               </span>┆<span class="w">          </span>┆<span class="w">                </span>┆<span class="w">           </span>┆<span class="w">         </span>┆<span class="w">            </span>│
│<span class="w"> </span>f1<span class="w">              </span>┆<span class="w">                 </span>┆<span class="w">          </span>┆<span class="w">                </span>┆<span class="w">           </span>┆<span class="w">         </span>┆<span class="w">            </span>│
│<span class="w"> </span>9c8aa64bbb878e3<span class="w"> </span>┆<span class="w"> </span>4e9a13e698f4fa1<span class="w"> </span>┆<span class="w"> </span><span class="m">0</span><span class="w">        </span>┆<span class="w"> </span><span class="m">0</span><span class="w">              </span>┆<span class="w"> </span><span class="m">117011</span><span class="w">    </span>┆<span class="w"> </span><span class="m">105186</span><span class="w">  </span>┆<span class="w"> </span><span class="m">11825</span><span class="w">      </span>│
│<span class="w"> </span>b62194f8dec670e<span class="w"> </span>┆<span class="w"> </span><span class="m">9</span><span class="w">               </span>┆<span class="w">          </span>┆<span class="w">                </span>┆<span class="w">           </span>┆<span class="w">         </span>┆<span class="w">            </span>│
│<span class="w"> </span>3c<span class="w">              </span>┆<span class="w">                 </span>┆<span class="w">          </span>┆<span class="w">                </span>┆<span class="w">           </span>┆<span class="w">         </span>┆<span class="w">            </span>│
│<span class="w"> </span>0ce2a8ce2c591e3<span class="w"> </span>┆<span class="w"> </span>5cd8a081758f41c<span class="w"> </span>┆<span class="w"> </span><span class="m">0</span><span class="w">        </span>┆<span class="w"> </span><span class="m">0</span><span class="w">              </span>┆<span class="w"> </span><span class="m">116961</span><span class="w">    </span>┆<span class="w"> </span><span class="m">105185</span><span class="w">  </span>┆<span class="w"> </span><span class="m">11776</span><span class="w">      </span>│
│<span class="w"> </span>4e92e0c421f3946<span class="w"> </span>┆<span class="w"> </span><span class="m">4</span><span class="w">               </span>┆<span class="w">          </span>┆<span class="w">                </span>┆<span class="w">           </span>┆<span class="w">         </span>┆<span class="w">            </span>│
│<span class="w"> </span><span class="m">14</span><span class="w">              </span>┆<span class="w">                 </span>┆<span class="w">          </span>┆<span class="w">                </span>┆<span class="w">           </span>┆<span class="w">         </span>┆<span class="w">            </span>│
│<span class="w"> </span>a941ace17a2c5e6<span class="w"> </span>┆<span class="w"> </span>a3726d0ebb2705c<span class="w"> </span>┆<span class="w"> </span><span class="m">0</span><span class="w">        </span>┆<span class="w"> </span><span class="m">0</span><span class="w">              </span>┆<span class="w"> </span><span class="m">116909</span><span class="w">    </span>┆<span class="w"> </span><span class="m">105186</span><span class="w">  </span>┆<span class="w"> </span><span class="m">11723</span><span class="w">      </span>│
│<span class="w"> </span>15a8f05d8872fa9<span class="w"> </span>┆<span class="w"> </span>d<span class="w">               </span>┆<span class="w">          </span>┆<span class="w">                </span>┆<span class="w">           </span>┆<span class="w">         </span>┆<span class="w">            </span>│
│<span class="w"> </span><span class="m">32</span><span class="w">              </span>┆<span class="w">                 </span>┆<span class="w">          </span>┆<span class="w">                </span>┆<span class="w">           </span>┆<span class="w">         </span>┆<span class="w">            </span>│
└─────────────────┴─────────────────┴──────────┴────────────────┴───────────┴─────────┴────────────┘
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile.print_external_operators">
<span class="sig-name descname"><span class="pre">print_external_operators</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile.print_external_operators" title="Permalink to this definition"></a></dt>
<dd><p>Print external operator report to the terminal.</p>
<p>The output will look like:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>┌────────────────────────────┬──────────────────┬───────────┬────────────┬────────────────┬────────┐
│<span class="w"> </span>trace_id<span class="w">                   </span>┆<span class="w"> </span>span_id<span class="w">          </span>┆<span class="w"> </span>thread.id<span class="w"> </span>┆<span class="w"> </span>name<span class="w">       </span>┆<span class="w"> </span>operator_index<span class="w"> </span>┆<span class="w"> </span>dur<span class="w">    </span>│
╞════════════════════════════╪══════════════════╪═══════════╪════════════╪════════════════╪════════╡
│<span class="w"> </span>7d65ff7ae5587d3345d5df5a77<span class="w"> </span>┆<span class="w"> </span>53e3fb9c02964361<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Quantize<span class="w">   </span>┆<span class="w"> </span><span class="m">0</span><span class="w">              </span>┆<span class="w"> </span><span class="m">175246</span><span class="w"> </span>│
│<span class="w"> </span>ebfaad<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>33371e09f89cfa06c41286df13<span class="w"> </span>┆<span class="w"> </span>8d5a00c6e4e8c2c0<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Lower<span class="w">      </span>┆<span class="w"> </span><span class="m">1</span><span class="w">              </span>┆<span class="w"> </span><span class="m">183803</span><span class="w"> </span>│
│<span class="w"> </span>11a30f<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>9f7df939abc20da11431c18024<span class="w"> </span>┆<span class="w"> </span>064dacd9a108c4a0<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Unlower<span class="w">    </span>┆<span class="w"> </span><span class="m">2</span><span class="w">              </span>┆<span class="w"> </span><span class="m">60459</span><span class="w">  </span>│
│<span class="w"> </span>c41af1<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>1bda703f4ffc878a4294ec6253<span class="w"> </span>┆<span class="w"> </span>cb2f103208d2fa45<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Dequantize<span class="w"> </span>┆<span class="w"> </span><span class="m">3</span><span class="w">              </span>┆<span class="w"> </span><span class="m">19468</span><span class="w">  </span>│
│<span class="w"> </span>3ac8d0<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>9f769c8951f39d98e6ee216e34<span class="w"> </span>┆<span class="w"> </span>91c0bdd8c5b81327<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Quantize<span class="w">   </span>┆<span class="w"> </span><span class="m">0</span><span class="w">              </span>┆<span class="w"> </span><span class="m">85724</span><span class="w">  </span>│
│<span class="w"> </span>6bc7e5<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>048e5cab6d4d676e4e6b10e827<span class="w"> </span>┆<span class="w"> </span>714834cb8dc59f4b<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Lower<span class="w">      </span>┆<span class="w"> </span><span class="m">1</span><span class="w">              </span>┆<span class="w"> </span><span class="m">306893</span><span class="w"> </span>│
│<span class="w"> </span>6b5489<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>6bb481ca3b1eab843b795a7865<span class="w"> </span>┆<span class="w"> </span>46d538d7b4c72d25<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Unlower<span class="w">    </span>┆<span class="w"> </span><span class="m">2</span><span class="w">              </span>┆<span class="w"> </span><span class="m">73313</span><span class="w">  </span>│
│<span class="w"> </span>49558b<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>e0f13a5fb0bf2942ed16171844<span class="w"> </span>┆<span class="w"> </span>71a432e3e3dc55f6<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Dequantize<span class="w"> </span>┆<span class="w"> </span><span class="m">3</span><span class="w">              </span>┆<span class="w"> </span><span class="m">37079</span><span class="w">  </span>│
│<span class="w"> </span>ccb293<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>c3b2fdba80f16f781e4b313af3<span class="w"> </span>┆<span class="w"> </span>066e3916590edf38<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Quantize<span class="w">   </span>┆<span class="w"> </span><span class="m">0</span><span class="w">              </span>┆<span class="w"> </span><span class="m">67805</span><span class="w">  </span>│
│<span class="w"> </span>a571b6<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>4bebe5f61e84d502f5b5dc7d22<span class="w"> </span>┆<span class="w"> </span>9dfb32069b2b5a98<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Lower<span class="w">      </span>┆<span class="w"> </span><span class="m">1</span><span class="w">              </span>┆<span class="w"> </span><span class="m">310303</span><span class="w"> </span>│
│<span class="w"> </span>1e4f5a<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>b8cabf53ae39a4ad18144af26c<span class="w"> </span>┆<span class="w"> </span>cb767fbdd718da89<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Unlower<span class="w">    </span>┆<span class="w"> </span><span class="m">2</span><span class="w">              </span>┆<span class="w"> </span><span class="m">72378</span><span class="w">  </span>│
│<span class="w"> </span>e136c9<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>e40956dda5ecc0a1774e39377b<span class="w"> </span>┆<span class="w"> </span>090d9cbd5e60032a<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Dequantize<span class="w"> </span>┆<span class="w"> </span><span class="m">3</span><span class="w">              </span>┆<span class="w"> </span><span class="m">33951</span><span class="w">  </span>│
│<span class="w"> </span>1ef245<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>3d13f40c0966940439adcce4c1<span class="w"> </span>┆<span class="w"> </span>4702a924e4b6d38b<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Quantize<span class="w">   </span>┆<span class="w"> </span><span class="m">0</span><span class="w">              </span>┆<span class="w"> </span><span class="m">76999</span><span class="w">  </span>│
│<span class="w"> </span>9981a4<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>53746b998038e994a5e378f9a2<span class="w"> </span>┆<span class="w"> </span>522b7a9e354de2b3<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Lower<span class="w">      </span>┆<span class="w"> </span><span class="m">1</span><span class="w">              </span>┆<span class="w"> </span><span class="m">339339</span><span class="w"> </span>│
│<span class="w"> </span>8caa5a<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>76a2080bc0917db26b7313e29a<span class="w"> </span>┆<span class="w"> </span>4b1b0bf55f344258<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Unlower<span class="w">    </span>┆<span class="w"> </span><span class="m">2</span><span class="w">              </span>┆<span class="w"> </span><span class="m">74708</span><span class="w">  </span>│
│<span class="w"> </span>81def3<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
│<span class="w"> </span>4c0a04dc669b04416f18e781d6<span class="w"> </span>┆<span class="w"> </span>8eb55fb2b618933a<span class="w"> </span>┆<span class="w"> </span><span class="m">35</span><span class="w">        </span>┆<span class="w"> </span>Dequantize<span class="w"> </span>┆<span class="w"> </span><span class="m">3</span><span class="w">              </span>┆<span class="w"> </span><span class="m">33661</span><span class="w">  </span>│
│<span class="w"> </span>afc3c6<span class="w">                     </span>┆<span class="w">                  </span>┆<span class="w">           </span>┆<span class="w">            </span>┆<span class="w">                </span>┆<span class="w">        </span>│
└────────────────────────────┴──────────────────┴───────────┴────────────┴────────────────┴────────┘
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile.print_inferences">
<span class="sig-name descname"><span class="pre">print_inferences</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile.print_inferences" title="Permalink to this definition"></a></dt>
<dd><p>Print inference summary to the terminal.</p>
<p>The output will look like:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>┌──────────────────────────────────┬──────────────────┬───────────┬─────────┐
│<span class="w"> </span>trace_id<span class="w">                         </span>┆<span class="w"> </span>span_id<span class="w">          </span>┆<span class="w"> </span>thread.id<span class="w"> </span>┆<span class="w"> </span>dur<span class="w">     </span>│
╞══════════════════════════════════╪══════════════════╪═══════════╪═════════╡
│<span class="w"> </span>b5edc4d40493df2028d186d4073d5487<span class="w"> </span>┆<span class="w"> </span>a61af3b9ad70b956<span class="w"> </span>┆<span class="w"> </span><span class="m">1</span><span class="w">         </span>┆<span class="w"> </span><span class="m">4430749</span><span class="w"> </span>│
│<span class="w"> </span>983e136f80e1c070dca3ad854f37cf97<span class="w"> </span>┆<span class="w"> </span>f2dd4e899d52531d<span class="w"> </span>┆<span class="w"> </span><span class="m">1</span><span class="w">         </span>┆<span class="w"> </span><span class="m">4181392</span><span class="w"> </span>│
│<span class="w"> </span>dada8a5830272b5d255fda801568fc5e<span class="w"> </span>┆<span class="w"> </span>cda7127619be5c33<span class="w"> </span>┆<span class="w"> </span><span class="m">1</span><span class="w">         </span>┆<span class="w"> </span><span class="m">4275757</span><span class="w"> </span>│
│<span class="w"> </span>6ad054709f76095c86fba6dcd9254ca0<span class="w"> </span>┆<span class="w"> </span>9d7f199a445003aa<span class="w"> </span>┆<span class="w"> </span><span class="m">1</span><span class="w">         </span>┆<span class="w"> </span><span class="m">4215571</span><span class="w"> </span>│
└──────────────────────────────────┴──────────────────┴───────────┴─────────┘
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile.print_summary">
<span class="sig-name descname"><span class="pre">print_summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile.print_summary" title="Permalink to this definition"></a></dt>
<dd><p>Print overall summary to the terminal.</p>
<p>The output will look like:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">================================================</span>
<span class="w">  </span>Inference<span class="w"> </span>Results<span class="w"> </span><span class="nv">Summary</span>
<span class="o">================================================</span>
Inference<span class="w"> </span>counts<span class="w">                </span>:<span class="w"> </span><span class="m">4</span>
Min<span class="w"> </span>latency<span class="w"> </span><span class="o">(</span>ns<span class="o">)</span><span class="w">                </span>:<span class="w"> </span><span class="m">4181392</span>
Max<span class="w"> </span>latency<span class="w"> </span><span class="o">(</span>ns<span class="o">)</span><span class="w">                </span>:<span class="w"> </span><span class="m">4430749</span>
Mean<span class="w"> </span>latency<span class="w"> </span><span class="o">(</span>ns<span class="o">)</span><span class="w">               </span>:<span class="w"> </span><span class="m">4275867</span>
Median<span class="w"> </span>latency<span class="w"> </span><span class="o">(</span>ns<span class="o">)</span><span class="w">             </span>:<span class="w"> </span><span class="m">4245664</span>
<span class="m">90</span>.0<span class="w"> </span>percentile<span class="w"> </span>Latency<span class="w"> </span><span class="o">(</span>ns<span class="o">)</span><span class="w">    </span>:<span class="w"> </span><span class="m">4384251</span>
<span class="m">95</span>.0<span class="w"> </span>percentile<span class="w"> </span>Latency<span class="w"> </span><span class="o">(</span>ns<span class="o">)</span><span class="w">    </span>:<span class="w"> </span><span class="m">4407500</span>
<span class="m">97</span>.0<span class="w"> </span>percentile<span class="w"> </span>Latency<span class="w"> </span><span class="o">(</span>ns<span class="o">)</span><span class="w">    </span>:<span class="w"> </span><span class="m">4416800</span>
<span class="m">99</span>.0<span class="w"> </span>percentile<span class="w"> </span>Latency<span class="w"> </span><span class="o">(</span>ns<span class="o">)</span><span class="w">    </span>:<span class="w"> </span><span class="m">4426099</span>
<span class="m">99</span>.9<span class="w"> </span>percentile<span class="w"> </span>Latency<span class="w"> </span><span class="o">(</span>ns<span class="o">)</span><span class="w">    </span>:<span class="w"> </span><span class="m">4430284</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="furiosa.runtime.profiler.profile.export_chrome_trace">
<span class="sig-name descname"><span class="pre">export_chrome_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.profiler.profile.export_chrome_trace" title="Permalink to this definition"></a></dt>
<dd><p>Export profiled data to a chrome tracing file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – filename to write.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="diagnostics">
<span id="id13"></span><h2>Diagnostics<a class="headerlink" href="#diagnostics" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.full_version">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">full_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.full_version" title="Permalink to this definition"></a></dt>
<dd><p>Returns a string for the full version of this package.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="furiosa.runtime.FuriosaRuntimeError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">FuriosaRuntimeError</span></span><a class="headerlink" href="#furiosa.runtime.FuriosaRuntimeError" title="Permalink to this definition"></a></dt>
<dd><p>A base class for all runtime exceptions.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.10: </span>Previously this was named <code class="docutils literal notranslate"><span class="pre">NativeException</span></code>
and was a subclass of <a class="reference internal" href="furiosa.common.html#furiosa.common.error.FuriosaError" title="furiosa.common.error.FuriosaError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FuriosaError</span></code></a>.
<a class="reference internal" href="#module-furiosa-runtime-errors"><span class="std std-ref">A large number of subclasses</span></a> were also removed,
to make a room for the upcoming restructuring.</p>
</div>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="furiosa.runtime.FuriosaRuntimeWarning">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.</span></span><span class="sig-name descname"><span class="pre">FuriosaRuntimeWarning</span></span><a class="headerlink" href="#furiosa.runtime.FuriosaRuntimeWarning" title="Permalink to this definition"></a></dt>
<dd><p>A base class for all runtime warnings.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.</span></p>
</div>
</dd></dl>

<p>This package currently doesn’t have a dedicated logging interface,
but the following environment variable can be used to set the basic logging level:</p>
<dl class="std envvar">
<dt class="sig sig-object std" id="envvar-FURIOSA_LOG_LEVEL">
<span class="sig-name descname"><span class="pre">FURIOSA_LOG_LEVEL</span></span><a class="headerlink" href="#envvar-FURIOSA_LOG_LEVEL" title="Permalink to this definition"></a></dt>
<dd><p>If set, should be either one of the following, in the order of decreasing verbosity:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">INFO</span></code> (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WARN</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ERROR</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OFF</span></code></p></li>
</ul>
</dd></dl>

</section>
<section id="legacy-supports">
<span id="id14"></span><h2>Legacy Supports<a class="headerlink" href="#legacy-supports" title="Permalink to this heading"></a></h2>
<p>The following submodules only exist to support <a class="reference internal" href="#runtime-variants"><span class="std std-ref">legacy codes</span></a>.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.10: </span>All legacy submodules will warn on import and any major incompatibilites will be reported.
Also unless otherwise stated, all functions and types described here are
either not available or will always fail.
The <code class="docutils literal notranslate"><span class="pre">[legacy]</span></code> extra may be used to disable these behavior
at the expense of the lack of the current APIs.</p>
</div>
<section id="module-furiosa.runtime.compiler">
<span id="furiosa-runtime-compiler"></span><h3>furiosa.runtime.compiler<a class="headerlink" href="#module-furiosa.runtime.compiler" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.compiler.generate_compiler_log_path">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.compiler.</span></span><span class="sig-name descname"><span class="pre">generate_compiler_log_path</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.compiler.generate_compiler_log_path" title="Permalink to this definition"></a></dt>
<dd><p>Generates a log path for compilation log.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
<p>This function is <a class="reference internal" href="#use-of-legacy-modules"><span class="std std-ref">legacy only</span></a>.</p>
</dd></dl>

</section>
<section id="module-furiosa.runtime.consts">
<span id="furiosa-runtime-consts"></span><h3>furiosa.runtime.consts<a class="headerlink" href="#module-furiosa.runtime.consts" title="Permalink to this heading"></a></h3>
<p>This module is empty.</p>
</section>
<section id="module-furiosa.runtime.envs">
<span id="furiosa-runtime-envs"></span><h3>furiosa.runtime.envs<a class="headerlink" href="#module-furiosa.runtime.envs" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.envs.current_npu_device">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.envs.</span></span><span class="sig-name descname"><span class="pre">current_npu_device</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.envs.current_npu_device" title="Permalink to this definition"></a></dt>
<dd><p>Returns the current npu device name.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>NPU device name</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
<p>This function is <a class="reference internal" href="#use-of-legacy-modules"><span class="std std-ref">legacy only</span></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.envs.is_compile_log_enabled">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.envs.</span></span><span class="sig-name descname"><span class="pre">is_compile_log_enabled</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.envs.is_compile_log_enabled" title="Permalink to this definition"></a></dt>
<dd><p>Returns True or False whether the compile log is enabled or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the compile log is enabled, or False.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a></p>
</dd>
</dl>
<p>This function is <a class="reference internal" href="#use-of-legacy-modules"><span class="std std-ref">legacy only</span></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.envs.log_dir">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.envs.</span></span><span class="sig-name descname"><span class="pre">log_dir</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.envs.log_dir" title="Permalink to this definition"></a></dt>
<dd><p>Returns FURIOSA_LOG_DIR where the logs are stored.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The log directory of Furiosa SDK</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
<p>This function is <a class="reference internal" href="#use-of-legacy-modules"><span class="std std-ref">legacy only</span></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.envs.profiler_output">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.envs.</span></span><span class="sig-name descname"><span class="pre">profiler_output</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.envs.profiler_output" title="Permalink to this definition"></a></dt>
<dd><p>Returns FURIOSA_PROFILER_OUTPUT_PATH where profiler outputs written.</p>
<p>For compatibility, NUX_PROFILER_PATH is also currently being supported,
but it will be deprecated by FURIOSA_PROFILER_OUTPUT_PATH later.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The file path of profiler output if specified, or None.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a> or None</p>
</dd>
</dl>
<p>This function is <a class="reference internal" href="#use-of-legacy-modules"><span class="std std-ref">legacy only</span></a>.</p>
</dd></dl>

</section>
<section id="module-furiosa.runtime.errors">
<span id="furiosa-runtime-errors"></span><span id="module-furiosa-runtime-errors"></span><h3>furiosa.runtime.errors<a class="headerlink" href="#module-furiosa.runtime.errors" title="Permalink to this heading"></a></h3>
<dl class="py exception">
<dt class="sig sig-object py" id="furiosa.runtime.errors.IncompatibleModel">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">IncompatibleModel</span></span><a class="headerlink" href="#furiosa.runtime.errors.IncompatibleModel" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.CompilationFailed">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">CompilationFailed</span></span><a class="headerlink" href="#furiosa.runtime.errors.CompilationFailed" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.InternalError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">InternalError</span></span><a class="headerlink" href="#furiosa.runtime.errors.InternalError" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.UnsupportedTensorType">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">UnsupportedTensorType</span></span><a class="headerlink" href="#furiosa.runtime.errors.UnsupportedTensorType" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.UnsupportedDataType">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">UnsupportedDataType</span></span><a class="headerlink" href="#furiosa.runtime.errors.UnsupportedDataType" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.IncompatibleApiClientError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">IncompatibleApiClientError</span></span><a class="headerlink" href="#furiosa.runtime.errors.IncompatibleApiClientError" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.InvalidYamlException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">InvalidYamlException</span></span><a class="headerlink" href="#furiosa.runtime.errors.InvalidYamlException" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.ApiClientInitFailed">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">ApiClientInitFailed</span></span><a class="headerlink" href="#furiosa.runtime.errors.ApiClientInitFailed" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.NoApiKeyException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">NoApiKeyException</span></span><a class="headerlink" href="#furiosa.runtime.errors.NoApiKeyException" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.InvalidSessionOption">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">InvalidSessionOption</span></span><a class="headerlink" href="#furiosa.runtime.errors.InvalidSessionOption" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.QueueWaitTimeout">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">QueueWaitTimeout</span></span><a class="headerlink" href="#furiosa.runtime.errors.QueueWaitTimeout" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.SessionTerminated">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">SessionTerminated</span></span><a class="headerlink" href="#furiosa.runtime.errors.SessionTerminated" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.DeviceBusy">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">DeviceBusy</span></span><a class="headerlink" href="#furiosa.runtime.errors.DeviceBusy" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.InvalidInput">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">InvalidInput</span></span><a class="headerlink" href="#furiosa.runtime.errors.InvalidInput" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.TensorNameNotFound">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">TensorNameNotFound</span></span><a class="headerlink" href="#furiosa.runtime.errors.TensorNameNotFound" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.UnsupportedFeature">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">UnsupportedFeature</span></span><a class="headerlink" href="#furiosa.runtime.errors.UnsupportedFeature" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.InvalidCompilerConfig">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">InvalidCompilerConfig</span></span><a class="headerlink" href="#furiosa.runtime.errors.InvalidCompilerConfig" title="Permalink to this definition"></a></dt>
<dt class="sig sig-object py" id="furiosa.runtime.errors.SessionClosed">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">furiosa.runtime.errors.</span></span><span class="sig-name descname"><span class="pre">SessionClosed</span></span><a class="headerlink" href="#furiosa.runtime.errors.SessionClosed" title="Permalink to this definition"></a></dt>
<dd><p>Specific subclasses of <code class="xref py py-obj docutils literal notranslate"><span class="pre">FuriosaRuntimeError</span></code>.</p>
<p>They are <a class="reference internal" href="#use-of-legacy-modules"><span class="std std-ref">legacy only</span></a> and
have been mostly replaced with standard Python exceptions like <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TypeError</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a>,
except for the following:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#furiosa.runtime.errors.DeviceBusy" title="furiosa.runtime.errors.DeviceBusy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeviceBusy</span></code></a></p></li>
<li><p><a class="reference internal" href="#furiosa.runtime.errors.InvalidInput" title="furiosa.runtime.errors.InvalidInput"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InvalidInput</span></code></a></p></li>
<li><p><a class="reference internal" href="#furiosa.runtime.errors.QueueWaitTimeout" title="furiosa.runtime.errors.QueueWaitTimeout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QueueWaitTimeout</span></code></a></p></li>
<li><p><a class="reference internal" href="#furiosa.runtime.errors.SessionClosed" title="furiosa.runtime.errors.SessionClosed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SessionClosed</span></code></a></p></li>
<li><p><a class="reference internal" href="#furiosa.runtime.errors.SessionTerminated" title="furiosa.runtime.errors.SessionTerminated"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SessionTerminated</span></code></a></p></li>
</ul>
</dd></dl>

<p>This module also reexports <code class="xref py py-obj docutils literal notranslate"><span class="pre">FuriosaRuntimeError</span></code> as <code class="docutils literal notranslate"><span class="pre">NativeException</span></code>.</p>
</section>
<section id="module-furiosa.runtime.model">
<span id="furiosa-runtime-model"></span><h3>furiosa.runtime.model<a class="headerlink" href="#module-furiosa.runtime.model" title="Permalink to this heading"></a></h3>
<p>This module reexports <code class="xref py py-obj docutils literal notranslate"><span class="pre">Model</span></code>.</p>
</section>
<section id="module-furiosa.runtime.session">
<span id="furiosa-runtime-session"></span><h3>furiosa.runtime.session<a class="headerlink" href="#module-furiosa.runtime.session" title="Permalink to this heading"></a></h3>
<p>This module reexports <a class="reference internal" href="#furiosa.runtime.session.Session" title="furiosa.runtime.session.Session"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Session</span></code></a>, <a class="reference internal" href="#furiosa.runtime.session.AsyncSession" title="furiosa.runtime.session.AsyncSession"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AsyncSession</span></code></a>, <a class="reference internal" href="#furiosa.runtime.session.CompletionQueue" title="furiosa.runtime.session.CompletionQueue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CompletionQueue</span></code></a>, <a class="reference internal" href="#furiosa.runtime.session.create" title="furiosa.runtime.session.create"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create</span></code></a> and <a class="reference internal" href="#furiosa.runtime.session.create_async" title="furiosa.runtime.session.create_async"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_async</span></code></a>.</p>
</section>
<section id="module-furiosa.runtime.tensor">
<span id="furiosa-runtime-tensor"></span><h3>furiosa.runtime.tensor<a class="headerlink" href="#module-furiosa.runtime.tensor" title="Permalink to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.tensor.numpy_dtype">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.tensor.</span></span><span class="sig-name descname"><span class="pre">numpy_dtype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.tensor.numpy_dtype" title="Permalink to this definition"></a></dt>
<dd><p>Returns numpy dtype from any eligible object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.tensor.zeros">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.tensor.</span></span><span class="sig-name descname"><span class="pre">zeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.tensor.zeros" title="Permalink to this definition"></a></dt>
<dd><p>Returns a zero tensor matching given tensor description.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>desc</strong> (<a class="reference internal" href="#furiosa.runtime.TensorDesc" title="furiosa.runtime.TensorDesc"><em>TensorDesc</em></a>) – Tensor description</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="furiosa.runtime.tensor.rand">
<span class="sig-prename descclassname"><span class="pre">furiosa.runtime.tensor.</span></span><span class="sig-name descname"><span class="pre">rand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#furiosa.runtime.tensor.rand" title="Permalink to this definition"></a></dt>
<dd><p>Returns a random tensor matching given tensor description.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>desc</strong> (<a class="reference internal" href="#furiosa.runtime.TensorDesc" title="furiosa.runtime.TensorDesc"><em>TensorDesc</em></a>) – Tensor description</p>
</dd>
</dl>
<p>This is meant to be a quick test function and
no guarantees are made for quality, performance and correctness.</p>
<p><a class="reference internal" href="#use-of-legacy-modules"><span class="std std-ref">Legacy only</span></a>: The function was only correctly defined for floating point types.</p>
</dd></dl>

<p>This module also contains <a class="reference internal" href="#furiosa.runtime.tensor.Tensor" title="furiosa.runtime.tensor.Tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Tensor</span></code></a> and <a class="reference internal" href="#furiosa.runtime.tensor.TensorArray" title="furiosa.runtime.tensor.TensorArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TensorArray</span></code></a>
which are described separately.</p>
<p>This module also reexports <code class="xref py py-obj docutils literal notranslate"><span class="pre">Axis</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">DataType</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">TensorDesc</span></code>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="furiosa.common.transport.html" class="btn btn-neutral float-left" title="furiosa.common.transport package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="furiosa.optimizer.html" class="btn btn-neutral float-right" title="furiosa.optimizer package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023 FuriosaAI, Inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>